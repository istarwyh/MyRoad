<!DOCTYPE html>

<html lang="en">

        <head>
                <!-- Page information -->
                <meta charset="UTF-8" />
                <meta name="node_id" content="junit5 & mockito">
                <meta name="viewport" content="width=device-width, initial-scale=1.0" />
                <link rel="shortcut icon" href="/favicon.ico" />

                <!-- Set title -->
                <title>æ™“ç°-åˆæ—©å¤©ç©ºåˆšä»æ··æ²Œä¸­é†’æ¥</title>

                <!-- Includes -->
                <script src="/obs.html/static/obsidian_core.js"></script>
<script src="/obs.html/static/encoding.js"></script>
<link rel="stylesheet" href="/obs.html/static/master.css" />
<script type="module">
    import mermaid from 'https://cdn.jsdelivr.net/npm/mermaid@10/dist/mermaid.esm.min.mjs';
    mermaid.initialize({
            'securityLevel': 'loose',
            'theme': 'dark',
            'themeVariables': {
                    'darkMode': true,
            }
    });
</script>
<script>
  MathJax = {
    loader: {
      load: [
        '[tex]/action',
        'output/chtml',
        '[tex]/centernot'
      ]
    },
    tex: {
      inlineMath: [ ["\\(","\\)"] ],
      displayMath: [ ["\\[","\\]"] ],
      processEscapes: true,
      processEnvironments: true,
      packages: {'[+]': ['centernot']}
    }
  };
</script>
<script type="text/javascript" id="MathJax-script" async
  src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js">
</script>
<script src="/obs.html/static/flexsearch.bundle.js"></script>
<script src="/obs.html/static/pako.js"></script>
<script src="/obs.html/static/search.js"></script>
<script src="/obs.html/static/dirtree.js"></script>




                <!-- Onload tweaks -->
                <script>
                        const CURRENT_NODE = 'junit5 & mockito';
                        const HTML_URL_PREFIX = '';
                        const PAGE_DEPTH = 3;
                </script>
        </head>

<body class="theme-obs-light">
        <div id="antiflash" style="display: none;"></div>
        <script>
                document.getElementById('antiflash').style.display = 'block';
        </script>
        <div id="search-master-div">
    <div id="search-slab" king_ramses="return the slaaab">
            <div id="search-controls">
                    <input id="search_string" placeholder="Type to search notes" type="text" />
                    <div class="tooltip" style="display: none;">
                        <input type="checkbox" id="hard_search" name="hard" />
                        <span class="tooltiptext">Hard search (require exact match)</span>
                    </div>
                    <div id="search-results-box">
                        <div id="search-results"></div>
                    </div>
                    <div id="search-instructions">
                        <div class="prompt-instruction mobile">
                            <button onclick="toggle_id('search-master-div');"><b>Close</b> Search </button>
                        </div>
                    </div>
            </div>
    </div>
</div>

<script>
    document.getElementById("search-master-div").addEventListener('click', e => {
            if(e.target !== e.currentTarget){
                    return
            }
            toggle_id('search-master-div');
    })
    document.getElementById("search_string").addEventListener("input", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    }); 
    document.getElementById("hard_search").addEventListener("click", function(event) {
            setTimeout( () =>run_search('search_string', 'hard_search'), 100 );
    });

    window.addEventListener('keydown', e => {
        if((e.key=='Escape'||e.key=='Esc'||e.keyCode==27)){
            toggle_id('search-master-div');
            return false;
        } 
    }, true);

    function click_list_link(element){
        element.parentElement.getElementsByTagName('a')[0].click()
    }
</script>

        <div id="page_holder" class="flex_col">
                <div id="header" class="header">
    <div id="header_flex" class="flex_row">
            <a href="/index.html" id="homelink" title="Clear screen and go to homepage">æ™“ç°-åˆæ—©å¤©ç©ºåˆšä»æ··æ²Œä¸­é†’æ¥</a>
            <div id="menu_toggle_button" class="navbar-button requires_js" onclick="toggle_menu()">
                    â‰¡
            </div>
            <div id="navbar" class="navbar requires_js">
                    <a class="navbar-link" href="/index.html" title="Home">Home</a>
<a class="navbar-link" href="/CyberFarmer.html" title="About">About</a>
<a class="navbar-link" href="/program/full-stream/Full-Stream.html" title="FULL-STREAM">FULL-STREAM</a>
<a class="navbar-link" href="/program/database/How-to-Choose-the-suitable-Database.html" title="CHOOSE-DB">CHOOSE-DB</a>
                    <div class="icon-tray">
                            <div id="theme-button" class="theme-button requires_js" title="Change theme" onclick="toggle_theme_popup(this)">
    T
</div>
<script>
    function toggle_theme_popup(el){
        // make theme button show that it's active by adding the .active class
        toggle(el);

        // show the theme selector
        toggle_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            toggle(pu);
        }
    }

    function disable_theme_popup(){
        disable_id('theme-button');

        // show the theme selector
        disable_id('theme-popup')

        let h2 = document.getElementById('header2')
        if (h2){
            let pu = document.getElementById('header2').getElementsByClassName('popup')[0];
            disable(pu);
        }
    }
</script>
                                    <div onclick="openSearch()" class="theme-button requires_js">
            <img src = "/obs.html/static/search.svg" alt="Search notes" title="Search notes" style="margin: 4px;"/>
        </div>
        <script>
            function openSearch(){
                // toggle search popup and continue with extra code if it is enabled this time
                if (toggle_id('search-master-div')){
                    // get input field and temporarily disable it
                    let ss = document.getElementById('search_string');
                    ss.value = 'Seach data initializing...';
                    ss.readOnly = true; 

                    // load search data if not yet done so
                    setTimeout(function(){
                        LoadSearchData()

                        // clear input and put focus on it so that we can start typing immediately
                        ss.value = '';
                        ss.readOnly = false; 
                        ss.focus()
                        ss.select()
                    }, 100);
                }
            }
        </script>
                                    <div class="graph_header_div requires_js">
            <a id="graph_link" class="system-link" href="/obs.html/graph/index.html?node=junit5 & mockito" title="Open fullpage Graph">
                    <img class="graph_header_div_svg" src = "/obs.html/static/graph.svg" alt="Open fullpage Graph" style="margin: 2px; width: 17px;"/>
            </a>
        </div>
                                    <div >
            <a id="dirtree_link" class="system-link" href="/obs.html/dir_index.html" title="View directory tree">
                    <img src = "/obs.html/static/dirtree.svg" style="width: 12px; padding: 4px;" alt="Directory tree link"/>
            </a>
        </div>
                            <div>
    <a href="/obs.html/tags/index.html" title="Open tag view">
            <img src = "/obs.html/static/hashtag.svg" alt="RSS Feed link" style="width: 24px; margin-left: -2px; margin-top: -2px;"/>
    </a>
</div>
                            
                    </div>
                    <div style="display: flex; flex-direction:column">
                        <div id="left_pane_toggle_nav" class="left_pane_toggle_nav">Toggle Directory Tree Pane</div>
                        <div id="right_pane_toggle_nav" class="right_pane_toggle_nav">Toggle Table of Contents Pane</div>
                    </div>
            </div>
    </div>
    <div class="popup" id="theme-popup">
    <label for="cars">Theme </label>

    <select name="theme" id="theme" onchange="set_theme(this.value)">
      <option value="obs-light" selected="selected">obsidian-light</option>
      <option value="obs-dark">obsidian-dark</option>
    </select> 
</div>
</div>
                <div class="flex_row">
                        <div id="left_pane" class="left_pane active">
    <div id="left_pane_fold_header" class="left_pane_fold_header fold_header">x</div>
    <div id="left_pane_content" class="left_pane_content">
            <div id="dirtree"><button id="folder-1" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>java</button>
<div id="folder-container-1" class="dir-container requires_js " path="/java">
	<ul class="dir-list">
		<li><div class="file-icon"></div><a class="" href="/java/Java Framework & Dependency.html"  >Java Framework & Dependency</a></li>
	</ul>
</div>
<button id="folder-2" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>learning</button>
<div id="folder-container-2" class="dir-container requires_js " path="/learning">
	<button id="folder-3" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>choice</button>
	<div id="folder-container-3" class="dir-container requires_js " path="/learning/choice">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/learning/choice/How-to-Choose-Note-Software.html"  >How-to-Choose-Note-Software</a></li>
		</ul>
	</div>
	<button id="folder-4" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>reading</button>
	<div id="folder-container-4" class="dir-container requires_js " path="/learning/reading">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/learning/reading/How-to-read-books-better.html"  >How-to-read-books-better</a></li>
			<li><div class="file-icon"></div><a class="" href="/learning/reading/Self-Determination-Theory.html"  >Self-Determination-Theory</a></li>
			<li><div class="file-icon"></div><a class="" href="/learning/reading/The Idea of History.html"  >The Idea of History</a></li>
			<li><div class="file-icon"></div><a class="" href="/learning/reading/The-Formula-The-Universal-Laws-of-Success.html"  >The-Formula-The-Universal-Laws-of-Success</a></li>
		</ul>
	</div>
	<button id="folder-5" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>wisdom</button>
	<div id="folder-container-5" class="dir-container requires_js " path="/learning/wisdom">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/learning/wisdom/Absent-Minded Learning Yields No Gain.html"  >Absent-Minded Learning Yields No Gain</a></li>
		</ul>
	</div>
	<ul class="dir-list">
		<li><div class="file-icon"></div><a class="" href="/learning/Frequently-Used-Prompt.html"  >Frequently-Used-Prompt</a></li>
		<li><div class="file-icon"></div><a class="" href="/learning/Information Diffusion.html"  >Information Diffusion</a></li>
		<li><div class="file-icon"></div><a class="" href="/learning/Information-Handler.html"  >Information-Handler</a></li>
	</ul>
</div>
<button id="folder-6" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>life</button>
<div id="folder-container-6" class="dir-container requires_js " path="/life">
	<button id="folder-7" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>experience</button>
	<div id="folder-container-7" class="dir-container requires_js " path="/life/experience">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/life/experience/Life-Experience.html"  >Life-Experience</a></li>
		</ul>
	</div>
	<button id="folder-8" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>story</button>
	<div id="folder-container-8" class="dir-container requires_js " path="/life/story">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/life/story/A-Love-That-Only-Made-Me-More-Insecure.html"  >A-Love-That-Only-Made-Me-More-Insecure</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/A-man-who-wants-to-save-face.html"  >A-man-who-wants-to-save-face</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/Alcohol Addiction.html"  >Alcohol Addiction</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/Fail-then-Two-year-For-Overseas-Education.html"  >Fail-then-Two-year-For-Overseas-Education</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/I have done my best-to-play-the-bad-hand-well.html"  >I have done my best-to-play-the-bad-hand-well</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/Marriage-Sale.html"  >Marriage-Sale</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/My ex-boyfriend destroys my worldview.html"  >My ex-boyfriend destroys my worldview</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/So-it-went-for-30-years.html"  >So-it-went-for-30-years</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/Step-by-Step-Error-Choice.html"  >Step-by-Step-Error-Choice</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/The construction industry has declined, where lies the new blue ocean.html"  >The construction industry has declined, where lies the new blue ocean</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/The loneliness after breaking up is really scary.html"  >The loneliness after breaking up is really scary</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/Trapped in the cycle of  anxiety-procrastination-depression-anxiety.html"  >Trapped in the cycle of  anxiety-procrastination-depression-anxiety</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/ZhangYiMing.html"  >ZhangYiMing</a></li>
			<li><div class="file-icon"></div><a class="" href="/life/story/resign from a state-owned enterprise job & give up their household registration to pursue self-discovery.html"  >resign from a state-owned enterprise job & give up their household registration to pursue self-discovery</a></li>
		</ul>
	</div>
	<ul class="dir-list">
		<li><div class="file-icon"></div><a class="" href="/life/How-to-choose-your-work.html"  >How-to-choose-your-work</a></li>
		<li><div class="file-icon"></div><a class="" href="/life/The-Era-When-HumansWill-Understand-Each-Other-Will-Eventually-Come.html"  >The-Era-When-HumansWill-Understand-Each-Other-Will-Eventually-Come</a></li>
		<li><div class="file-icon"></div><a class="" href="/life/ä¿¡æ¯ç‰¢ç¬¼.html"  >ä¿¡æ¯ç‰¢ç¬¼</a></li>
	</ul>
</div>
<button id="folder-9" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>program</button>
<div id="folder-container-9" class="dir-container requires_js active" path="/program">
	<button id="folder-10" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>architecher</button>
	<div id="folder-container-10" class="dir-container requires_js " path="/program/architecher">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/architecher/Code-or-Design-Pattern.html"  >Code-or-Design-Pattern</a></li>
		</ul>
	</div>
	<button id="folder-11" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>bot</button>
	<div id="folder-container-11" class="dir-container requires_js " path="/program/bot">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/bot/Ding-Ding-Bot.html"  >Ding-Ding-Bot</a></li>
		</ul>
	</div>
	<button id="folder-12" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>database</button>
	<div id="folder-container-12" class="dir-container requires_js " path="/program/database">
		<button id="folder-13" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>HTAP</button>
		<div id="folder-container-13" class="dir-container requires_js " path="/program/database/HTAP">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/database/HTAP/Hologres.html"  >Hologres</a></li>
			</ul>
		</div>
		<button id="folder-14" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>kv_memory</button>
		<div id="folder-container-14" class="dir-container requires_js " path="/program/database/kv_memory">
			<button id="folder-15" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>vx_images</button>
			<div id="folder-container-15" class="dir-container requires_js " path="/program/database/kv_memory/vx_images">
				<ul class="dir-list">
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/2125296809846.png"  class="external-link">2125296809846.png</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/2543722787409.png"  class="external-link">2543722787409.png</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/324746178980.jpg"  class="external-link">324746178980.jpg</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/5493237811439.png"  class="external-link">5493237811439.png</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/5920443129073.png"  class="external-link">5920443129073.png</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/aeFd.gif"  class="external-link">aeFd.gif</a></li>
					<li><div class="file-icon non-md-file"></div><a class="" href="/program/database/kv_memory/vx_images/epoll.gif"  class="external-link">epoll.gif</a></li>
				</ul>
			</div>
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/database/kv_memory/Redisæºç æ¶æ„é˜…è¯».html"  >Redisæºç æ¶æ„é˜…è¯»</a></li>
			</ul>
		</div>
		<button id="folder-16" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>olap</button>
		<div id="folder-container-16" class="dir-container requires_js " path="/program/database/olap">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/database/olap/Optimized-Row-Columnar.html"  >Optimized-Row-Columnar</a></li>
			</ul>
		</div>
		<button id="folder-17" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>product</button>
		<div id="folder-container-17" class="dir-container requires_js " path="/program/database/product">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/database/product/Bigtable.html"  >Bigtable</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/database/product/OceanBase.html"  >OceanBase</a></li>
			</ul>
		</div>
		<button id="folder-18" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>relational_database</button>
		<div id="folder-container-18" class="dir-container requires_js " path="/program/database/relational_database">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/database/relational_database/MySQL FAQ.html"  >MySQL FAQ</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/database/relational_database/MySQL Index Introduction.html"  >MySQL Index Introduction</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/database/relational_database/Possible Problems with Sharding and Partitioning.html"  >Possible Problems with Sharding and Partitioning</a></li>
			</ul>
		</div>
		<button id="folder-19" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>search</button>
		<div id="folder-container-19" class="dir-container requires_js " path="/program/database/search">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/database/search/Inverted-Index-of-Lucene-and-B-Tree.html"  >Inverted-Index-of-Lucene-and-B-Tree</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/database/Binlog Master-Slave Data Synchronization.html"  >Binlog Master-Slave Data Synchronization</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Common Metrics of MySQL.html"  >Common Metrics of MySQL</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Database Solutions for Distributed Systems.html"  >Database Solutions for Distributed Systems</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Horizontal Scaling.html"  >Horizontal Scaling</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/How-to-Choose-the-Suitable-Database.html"  >How-to-Choose-the-Suitable-Database</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Prevention and Monitoring of Slow SQL.html"  >Prevention and Monitoring of Slow SQL</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Redo-log Master-Slave Data Synchronization.html"  >Redo-log Master-Slave Data Synchronization</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/SST(Sorted String Table).html"  >SST(Sorted String Table)</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Storage-Compute Architecture.html"  >Storage-Compute Architecture</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/database/Write-Ahead Logging.html"  >Write-Ahead Logging</a></li>
		</ul>
	</div>
	<button id="folder-20" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>full-stream</button>
	<div id="folder-container-20" class="dir-container requires_js active" path="/program/full-stream">
		<button id="folder-21" class="dir-button active" onclick="toggle_dir(this.id)"><div class="file-icon"></div>Test</button>
		<div id="folder-container-21" class="dir-container requires_js active" path="/program/full-stream/Test">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="active current_page_dirtree" href="/program/full-stream/Test/JUnit5 & Mockito.html"  >JUnit5 & Mockito</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/full-stream/Test/Test Need Geek.html"  >Test Need Geek</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/full-stream/Test/Unit Level Test Theoryã€Toolã€Discussion.html"  >Unit Level Test Theoryã€Toolã€Discussion</a></li>
			</ul>
		</div>
		<button id="folder-22" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>seo</button>
		<div id="folder-container-22" class="dir-container requires_js " path="/program/full-stream/seo">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/full-stream/seo/Search Engine Optimization.html"  >Search Engine Optimization</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/full-stream/Analyzing.html"  >Analyzing</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/full-stream/Code-Oriented-Draw.html"  >Code-Oriented-Draw</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/full-stream/Full-Stream.html"  >Full-Stream</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/full-stream/Modeling.html"  >Modeling</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/full-stream/Prototype-Diagram.html"  >Prototype-Diagram</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/program/full-stream/full-stream.canvas"  class="external-link">full-stream.canvas</a></li>
		</ul>
	</div>
	<button id="folder-23" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>llm</button>
	<div id="folder-container-23" class="dir-container requires_js " path="/program/llm">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/llm/Enhanced-Search-With-AI.excalidraw.html"  >Enhanced-Search-With-AI.excalidraw</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/llm/Vector-Database.html"  >Vector-Database</a></li>
		</ul>
	</div>
	<button id="folder-24" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>networking</button>
	<div id="folder-container-24" class="dir-container requires_js " path="/program/networking">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/networking/RDMA.html"  >RDMA</a></li>
		</ul>
	</div>
	<button id="folder-25" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>operation-system</button>
	<div id="folder-container-25" class="dir-container requires_js " path="/program/operation-system">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/operation-system/PageCache.html"  >PageCache</a></li>
		</ul>
	</div>
	<button id="folder-26" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>practices</button>
	<div id="folder-container-26" class="dir-container requires_js " path="/program/practices">
		<button id="folder-27" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>Distributed System</button>
		<div id="folder-container-27" class="dir-container requires_js " path="/program/practices/Distributed System">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/practices/Distributed System/Distributed System Problems.html"  >Distributed System Problems</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/practices/Distributed System/Master-Slave-Switch.html"  >Master-Slave-Switch</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/practices/Distributed System/Optimize Kinds of Resource Use.html"  >Optimize Kinds of Resource Use</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/practices/Distributed System/Paxos.html"  >Paxos</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/practices/Distributed System/Raft.html"  >Raft</a></li>
				<li><div class="file-icon"></div><a class="" href="/program/practices/Distributed System/ç¼“å­˜å¸¦æ¥çš„å„ç§é—®é¢˜.html"  >ç¼“å­˜å¸¦æ¥çš„å„ç§é—®é¢˜</a></li>
			</ul>
		</div>
		<button id="folder-28" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>Git</button>
		<div id="folder-container-28" class="dir-container requires_js " path="/program/practices/Git">
			<ul class="dir-list">
				<li><div class="file-icon"></div><a class="" href="/program/practices/Git/Frequently Git Command.html"  >Frequently Git Command</a></li>
			</ul>
		</div>
		<ul class="dir-list">
			<li><div class="file-icon non-md-file"></div><a class="" href="/program/practices/Classic Process Data Infrastructure.canvas"  class="external-link">Classic Process Data Infrastructure.canvas</a></li>
			<li><div class="file-icon non-md-file"></div><a class="" href="/program/practices/Finance Technology Area Relation.canvas"  class="external-link">Finance Technology Area Relation.canvas</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/practices/Frequently-IDEA-Shortcut.html"  >Frequently-IDEA-Shortcut</a></li>
			<li><div class="file-icon"></div><a class="" href="/program/practices/Practices-for-Processing-l0-Billion-Bill-data.html"  >Practices-for-Processing-l0-Billion-Bill-data</a></li>
		</ul>
	</div>
	<button id="folder-29" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>technology</button>
	<div id="folder-container-29" class="dir-container requires_js " path="/program/technology">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/program/technology/Distributed Computing.html"  >Distributed Computing</a></li>
		</ul>
	</div>
	<ul class="dir-list">
	</ul>
</div>
<button id="folder-30" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>society</button>
<div id="folder-container-30" class="dir-container requires_js " path="/society">
	<ul class="dir-list">
		<li><div class="file-icon non-md-file"></div><a class="" href="/society/ä¸šè´¢ä¸€ä½“.canvas"  class="external-link">ä¸šè´¢ä¸€ä½“.canvas</a></li>
	</ul>
</div>
<button id="folder-31" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>store</button>
<div id="folder-container-31" class="dir-container requires_js " path="/store">
	<button id="folder-32" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>Buffer</button>
	<div id="folder-container-32" class="dir-container requires_js " path="/store/Buffer">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/store/Buffer/Java Fuzz Test.html"  >Java Fuzz Test</a></li>
		</ul>
	</div>
	<button id="folder-33" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>history-program</button>
	<div id="folder-container-33" class="dir-container requires_js " path="/store/history-program">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/store/history-program/Knowledge-Management-System.html"  >Knowledge-Management-System</a></li>
			<li><div class="file-icon"></div><a class="" href="/store/history-program/Servicer-Chat-System.excalidraw.html"  >Servicer-Chat-System.excalidraw</a></li>
			<li><div class="file-icon"></div><a class="" href="/store/history-program/index-insight.excalidraw.html"  >index-insight.excalidraw</a></li>
			<li><div class="file-icon"></div><a class="" href="/store/history-program/æ·˜å·¥å‚å®¢æœçŸ¥è¯†åº“å’Œé—®ç­”ç›¸å…³çš„å·¥ä½œ.html"  >æ·˜å·¥å‚å®¢æœçŸ¥è¯†åº“å’Œé—®ç­”ç›¸å…³çš„å·¥ä½œ</a></li>
		</ul>
	</div>
	<button id="folder-34" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>å¾®ä¿¡å…¬ä¼—å·</button>
	<div id="folder-container-34" class="dir-container requires_js " path="/store/å¾®ä¿¡å…¬ä¼—å·">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/store/å¾®ä¿¡å…¬ä¼—å·/å‡å¦‚ä½ äº”è¡Œå±å•†å®¶ï¼Œå¦‚ä½•å’Œæ·˜å¤©åšç”Ÿæ„ï¼Ÿ.html"  >å‡å¦‚ä½ äº”è¡Œå±å•†å®¶ï¼Œå¦‚ä½•å’Œæ·˜å¤©åšç”Ÿæ„ï¼Ÿ</a></li>
		</ul>
	</div>
	<ul class="dir-list">
	</ul>
</div>
<button id="folder-35" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>story</button>
<div id="folder-container-35" class="dir-container requires_js " path="/story">
	<button id="folder-36" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>history</button>
	<div id="folder-container-36" class="dir-container requires_js " path="/story/history">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/story/history/Alibaba-C2M.html"  >Alibaba-C2M</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/history/Others' Story.html"  >Others' Story</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/history/Xiao-Hong-Shu.html"  >Xiao-Hong-Shu</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/history/mdnice.html"  >mdnice</a></li>
		</ul>
	</div>
	<button id="folder-37" class="dir-button " onclick="toggle_dir(this.id)"><div class="file-icon"></div>observe</button>
	<div id="folder-container-37" class="dir-container requires_js " path="/story/observe">
		<ul class="dir-list">
			<li><div class="file-icon"></div><a class="" href="/story/observe/Customer-Behavior.html"  >Customer-Behavior</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/observe/E-Commerce Business Models.html"  >E-Commerce Business Models</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/observe/High-risk Areas for Young People's Entrepreneurship Failure.html"  >High-risk Areas for Young People's Entrepreneurship Failure</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/observe/Overseas Lack of Chinese Similar Products.html"  >Overseas Lack of Chinese Similar Products</a></li>
			<li><div class="file-icon"></div><a class="" href="/story/observe/Work Involved In Opening an E-Commerce Store.html"  >Work Involved In Opening an E-Commerce Store</a></li>
		</ul>
	</div>
	<ul class="dir-list">
		<li><div class="file-icon"></div><a class="" href="/story/Start-up Resources Collection.html"  >Start-up Resources Collection</a></li>
		<li><div class="file-icon"></div><a class="" href="/story/æœç´¢éœ€æ±‚çš„åˆ†æµ.html"  >æœç´¢éœ€æ±‚çš„åˆ†æµ</a></li>
	</ul>
</div>
<ul class="dir-list">
	<li><div class="file-icon"></div><a class="" href="/A Brand Called xiaohui.html"  >A Brand Called xiaohui</a></li>
	<li><div class="file-icon"></div><a class="" href="/Blog-Technology-Stack.html"  >Blog-Technology-Stack</a></li>
	<li><div class="file-icon"></div><a class="" href="/CyberFarmer.html"  >CyberFarmer</a></li>
	<li><div class="file-icon"></div><a class="" href="/Story.html"  >Story</a></li>
	<li><div class="file-icon"></div><a class="" href="/index.html"  >index</a></li>
	<li><div class="file-icon"></div><a class="" href="/xiaohui-blog-technology-architecture.excalidraw.html"  >xiaohui-blog-technology-architecture.excalidraw</a></li>
</ul>
</div>
    </div>
</div>
                        <div class="container">
                                <div class="content"><h1 id="junit5-mockito">JUnit5 &amp; Mockito</h1>
<div class="toc">
<ul>
<li><a href="#junit5-mockito" class="anchor-link">JUnit5 &amp; Mockito</a><ul>
<li><a href="#h_1" class="anchor-link">1. å‰è¨€</a></li>
<li><a href="#h_2-junit5" class="anchor-link">2. JUnit5 ä½¿ç”¨ä¸åŸç†</a><ul>
<li><a href="#h_2-1" class="anchor-link">2.1. æ–°çš„æ³¨è§£</a></li>
<li><a href="#h_2-2" class="anchor-link">2.2. æ–°çš„ç‰¹æ€§</a><ul>
<li><a href="#h_2-2-1" class="anchor-link">2.2.1. è¶…æ—¶æ–­è¨€</a></li>
<li><a href="#h_2-2-2" class="anchor-link">2.2.2. å‚æ•°åŒ–æµ‹è¯•</a><ul>
<li><a href="#h_2-2-2-1" class="anchor-link">2.2.2.1. ä¼ å…¥å•ä¸ªå‚æ•°</a></li>
<li><a href="#h_2-2-2-2" class="anchor-link">2.2.2.2. ä¼ å…¥å¤šä¸ªå‚æ•°</a></li>
<li><a href="#h_2-2-2-3" class="anchor-link">2.2.2.3. ä¼ å…¥å¯¹è±¡&amp;å¤§é‡æ•°æ®(æ–‡ä»¶)</a></li>
<li><a href="#h_2-2-2-4" class="anchor-link">2.2.2.4. æ‰©å±•</a></li>
</ul>
</li>
<li><a href="#h_2-2-3" class="anchor-link">2.2.3. é‡å¤ä¸å¹¶å‘æµ‹è¯•</a><ul>
<li><a href="#h_2-2-3-1" class="anchor-link">2.2.3.1. é‡å¤æµ‹è¯•</a></li>
<li><a href="#h_2-2-3-2" class="anchor-link">2.2.3.2. å¹¶å‘æµ‹è¯•</a></li>
</ul>
</li>
<li><a href="#h_2-2-4" class="anchor-link">2.2.4. å¯¹ç±»ä¸­å•å…ƒæµ‹è¯•åˆ†ç»„</a></li>
</ul>
</li>
<li><a href="#h_2-3-junit5" class="anchor-link">2.3. JUnit5åŸç†</a></li>
</ul>
</li>
<li><a href="#h_3-mockito" class="anchor-link">3. Mockitoä½¿ç”¨ä¸åŸç†</a><ul>
<li><a href="#h_3-1" class="anchor-link">3.1. å¸¸ç”¨æ³¨è§£</a><ul>
<li><a href="#h_3-1-1" class="anchor-link">3.1.1. ä»‹ç»</a></li>
<li><a href="#h_3-1-2" class="anchor-link">3.1.2. ä½¿ç”¨å»ºè®®</a><ul>
<li><a href="#h_3-1-2-1" class="anchor-link">3.1.2.1. æ³¨è§£å¸¸ç”¨å®è·µ</a></li>
<li><a href="#h_3-1-2-2-mockito-patterns" class="anchor-link">3.1.2.2. Mockito Patterns:</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#h_3-2-mockito" class="anchor-link">3.2. MockitoåŸç†</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<h2 id="h_1">1. å‰è¨€</h2>
<p>Junitç³»åˆ—å¯ä»¥è§£å†³æµ‹è¯•å¯åŠ¨ã€æµ‹è¯•çŠ¶æ€æ ¡éªŒä¸ç»„ç»‡çš„é—®é¢˜,æ¯”å¦‚æµ‹è¯•å¯åŠ¨ä¸Šæœ‰å‚æ•°åŒ–æµ‹è¯•ã€å¹¶å‘æµ‹è¯•ã€é¡ºåºæµ‹è¯•ç­‰åŠŸèƒ½,æ ¡éªŒä¸Šæœ‰å¼‚å¸¸æ–­è¨€ã€è¶…æ—¶æ–­è¨€ç­‰åŠŸèƒ½,ä»£ç ç»„ç»‡ä¸Šæœ‰æµ‹è¯•åˆ†ç»„ã€æµ‹è¯•æŠ¥å‘Šè‡ªå®šä¹‰ç­‰åŠŸèƒ½. <br />
åœ¨ä¸Šè¿°é¢†åŸŸä¹‹å¤–,Mockitoå¾ˆå¥½åœ°æ‰¿æ‹…äº†å¯¹æµ‹è¯•å¯¹è±¡æ‰“æ¡©(stub)ä»¥åŠå¯¹æµ‹è¯•è¡Œä¸ºæ ¡éªŒçš„åŠŸèƒ½.æœ‰äººå¯èƒ½æ‰€Mockitoéƒ½ä¸èƒ½mockç§æœ‰ã€é™æ€å’Œæ„é€ æ–¹æ³•,å·®è¯„!(è™½ç„¶<a href="#jump" class="anchor-link">è¦ä¸è¦æµ‹è¯•ç§æœ‰æ–¹æ³•è¿˜æ²¡æœ‰å®šè®º</a>é‚£ä½ å¯ä»¥ä»ä¸‹é¢æŒ‘ä¸€æ¬¾!   </p>
<table>
<thead>
<tr>
<th>å·¥å…·</th>
<th>åŸç†</th>
<th>æœ€å°Mock Unit</th>
<th>å¯¹è¢«Mockæ–¹æ³•çš„é™åˆ¶</th>
<th>ä¸Šæ‰‹éš¾åº¦</th>
<th>æ€»ç»“</th>
</tr>
</thead>
<tbody>
<tr>
<td>Mockito</td>
<td>åŠ¨æ€ä»£ç†</td>
<td>ç±»</td>
<td>ä¸èƒ½mockç§æœ‰ã€é™æ€å’Œæ„é€ æ–¹æ³•</td>
<td>ä¸€èˆ¬</td>
<td>æ¯”è¾ƒå…¨é¢å°±æ˜¯ä¸èƒ½mockæ–¹æ³•æœ‰é™åˆ¶</td>
</tr>
<tr>
<td>Spock</td>
<td>åŠ¨æ€ä»£ç†</td>
<td>ç±»</td>
<td>ä¸èƒ½mockç§æœ‰ã€é™æ€å’Œæ„é€ æ–¹æ³•</td>
<td>è¾ƒå¤æ‚</td>
<td>å¯è¯»æ€§å¥½;mockä¸Šä¹Ÿæœ‰é™åˆ¶</td>
</tr>
<tr>
<td>PowerMock</td>
<td>è‡ªå®šä¹‰ç±»åŠ è½½å™¨</td>
<td>ç±»</td>
<td><strong>éƒ½å¯ä»¥</strong></td>
<td>è¾ƒå¤æ‚</td>
<td>Jacocoé»˜è®¤æƒ…å†µä¸‹ä¸èƒ½ç»Ÿè®¡è¦†ç›–ç‡</td>
</tr>
<tr>
<td>JMockit</td>
<td>è¿è¡Œæ—¶ä¿®æ”¹å­—èŠ‚ç </td>
<td>ç±»</td>
<td>ä¸èƒ½mockæ„é€ æ–¹æ³•</td>
<td>è¾ƒå¤æ‚</td>
<td>ç›®å‰ä¸å’‹è¢«ç»´æŠ¤</td>
</tr>
<tr>
<td>TestableMock</td>
<td>è¿è¡Œæ—¶ä¿®æ”¹å­—èŠ‚ç </td>
<td>æ–¹æ³•</td>
<td><strong>éƒ½å¯ä»¥</strong></td>
<td>å®¹æ˜“</td>
<td>æ€è·¯æ¸…å¥‡,æŒ‡å“ªæ‰“å“ª,ä¸Šæ‰‹ç®€å•</td>
</tr>
</tbody>
</table>
<p>è¿™é‡Œä¹Ÿå•ç‹¬æä¸€ä¸‹<a href="https://alibaba.github.io/testable-mock/" class="external-link">TestableMock</a>. å®ƒç»•å¼€äº†ä¼ ç»ŸMockå·¥å…·å…ˆmockå¯¹è±¡çš„æ€è·¯,ç›´æ¥ä¿®æ”¹è¿è¡Œæ—¶è¢«è°ƒç”¨çš„æ–¹æ³•,è€Œè¿™åªéœ€ç”¨ä¸€ä¸ª<code>@MockInvoke</code>æ³¨è§£å³å¯. <br />
ç„¶è€ŒMockitoåªæ˜¯æ–¹ä¾¿å¼€å‘è€…mockæ•°æ®,å´ä¸èƒ½å¸®å¼€å‘è€…æŠŠæ•°æ®é€ å‡ºæ¥,åœ¨å¤æ‚çš„ä¸šåŠ¡åœºæ™¯ä¸‹,å¦‚ä½•å¿«é€Ÿç”Ÿæˆæœ‰ä¸šåŠ¡å«ä¹‰çš„å¯¹è±¡æˆ–è€…å“åº”ä½“ä¾ç„¶æ—¶å¾ˆéº»çƒ¦çš„é—®é¢˜.<strong>æˆ‘ä»¬è¿˜éœ€è¦ä¸€ä¸ªå·¥å…·æ–¹ä¾¿æˆ‘ä»¬ä»è¿è¡Œæ—¶è·å–ä¾èµ–æ•°æ®.</strong>   </p>
<h2 id="h_2-junit5">2. JUnit5 ä½¿ç”¨ä¸åŸç†</h2>
<p>åœ¨JUnit4å‘å¸ƒåå¹´ä¹‹å,2017å¹´JUnitå›¢é˜Ÿé ä¼—ç­¹æ¨å‡ºäº†å…¨æ–°çš„<a href="https://junit.org/junit5/docs/current/user-guide/#overview-what-is-junit-5" class="external-link" class="external-link">JUnit5</a>.   </p>
<p><center>JUnit 5 = JUnit Platform + JUnit Jupiter + JUnit Vintage</center>   </p>
<ul>
<li>
<p>JUnit Platform: åœ¨ JVM ä¸Š<a href="https://junit.org/junit5/docs/current/user-guide/#launcher-api" class="external-link">å¯åŠ¨æµ‹è¯•æ¡†æ¶</a>çš„åŸºç¡€ï¼Œä¸ä»…æ”¯æŒ Junit çš„æµ‹è¯•å¼•æ“<a href="https://junit.org/junit5/docs/current/api/org.junit.platform.engine/org/junit/platform/engine/TestEngine.html" class="external-link">TestEngine</a>ï¼Œå…¶ä»–æµ‹è¯•å¼•æ“ä¹Ÿéƒ½å¯ä»¥æ¥å…¥ã€‚   </p>
</li>
<li>
<p>JUnit Jupiter: JUnit JupiteråŒæ—¶æ”¯æŒJUnit5æ–°çš„<a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests" class="external-link">programming model </a>ä»¥åŠè€çš„<a href="https://junit.org/junit5/docs/current/user-guide/#extensions" class="external-link">Extension Model</a>.Jupiterå®ç°äº†è‡ªå·±çš„TestEngineã€‚   </p>
</li>
<li>
<p>JUnit Vintage: ä¸ºäº†å‘åå…¼å®¹æä¾›çš„TestEngine,æ”¯æŒè¿è¡ŒJUnit4,Junit3çš„æµ‹è¯•.æ³¨æ„ç±»è·¯å¾„æˆ–è€…æ¨¡å—è·¯å¾„è‡³å°‘åŒ…å«JUnit 4.12ä»¥ä»¥ä¸Šç‰ˆæœ¬.   </p>
</li>
</ul>
<p><img alt="" src="https://gitee.com/istarwyh/images/raw/master/vnote/ç¨‹åºå‘˜ç»ƒçº§ä¹‹è·¯/å·¥ç¨‹å®è·µ/æµ‹è¯•/junit5&amp;mockito.md/450935910220547.png" />   </p>
<p>è™½ç„¶åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†,ä¸è¿‡æœ€æ–°ç‰ˆæœ¬å¼•å…¥<code>org.junit.jupiter:junit-jupiter</code>å°±å¯ä»¥äº†,æ ¸å¿ƒæ³¨è§£éƒ½åœ¨<code>org.junit.jupiter.api</code>ä¸‹.   </p>
<h3 id="h_2-1">2.1. æ–°çš„æ³¨è§£</h3>
<p>ä¸‹é¢æŒ‰ç…§æˆ‘ä¸ªäººç»éªŒåˆ—ä¸¾JUni5çš„æ–°æ³¨è§£,æ›´å¤šçš„åœ¨<a href="https://junit.org/junit5/docs/current/user-guide/#overview-what-is-junit-5" class="external-link" class="external-link">è¿™é‡Œ</a>:   </p>
<table>
<thead>
<tr>
<th>Annotation</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>@Test</td>
<td>å’Œ JUnit4 çš„ @Test ä¸åŒï¼Œè¿™ä¸ª@Testä¸èƒ½å£°æ˜ä»»ä½•å±æ€§ï¼ŒJupiterä¼šä¸ºä¸åŒçš„test extensionæä¾›ä¸“é—¨æ³¨è§£</td>
</tr>
<tr>
<td>@ParameterizedTest</td>
<td>è¡¨ç¤ºæ–¹æ³•æ˜¯å‚æ•°åŒ–æµ‹è¯•</td>
</tr>
<tr>
<td>@RepeatedTest</td>
<td>è¡¨ç¤ºæ–¹æ³•å¯é‡å¤æ‰§è¡Œ,å¯é…åˆå¹¶å‘æµ‹è¯•</td>
</tr>
<tr>
<td>@DisplayName</td>
<td>ä¸ºæµ‹è¯•ç±»æˆ–è€…æµ‹è¯•æ–¹æ³•è®¾ç½®å±•ç¤ºåç§°,æ”¯æŒemojiğŸ˜„</td>
</tr>
<tr>
<td>@BeforeEach</td>
<td>è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•ä¹‹å‰æ‰§è¡Œ</td>
</tr>
<tr>
<td>@AfterEach</td>
<td>è¡¨ç¤ºåœ¨æ¯ä¸ªå•å…ƒæµ‹è¯•ä¹‹åæ‰§è¡Œ</td>
</tr>
<tr>
<td>@BeforeAll</td>
<td>è¡¨ç¤ºåœ¨æ‰€æœ‰å•å…ƒæµ‹è¯•ä¹‹å‰æ‰§è¡Œ</td>
</tr>
<tr>
<td>@After all</td>
<td>è¡¨ç¤ºåœ¨æ‰€æœ‰å•å…ƒæµ‹è¯•ä¹‹åæ‰§è¡Œ</td>
</tr>
<tr>
<td>@Disabled</td>
<td>è¡¨ç¤ºæµ‹è¯•ç±»æˆ–æµ‹è¯•æ–¹æ³•ä¸æ‰§è¡Œï¼Œç±»ä¼¼äº JUnit4 ä¸­çš„ @Ignore</td>
</tr>
<tr>
<td>@Timeout</td>
<td>è¡¨ç¤ºæµ‹è¯•æ–¹æ³•è¿è¡Œå¦‚æœè¶…è¿‡äº†æŒ‡å®šæ—¶é—´å°†ä¼šè¿”å›é”™è¯¯</td>
</tr>
<tr>
<td>@Nested</td>
<td>è¯¥æ³¨è§£å…è®¸åœ¨æµ‹è¯•ç±»ä¸­å®šä¹‰éé™æ€æµ‹è¯•ç±».@BeforeAllä¸@AfterAllä¸ç›´æ¥é€‚ç”¨äº@Nestedæµ‹è¯•ç±»</td>
</tr>
<tr>
<td>@TestClassOrder</td>
<td>æŒ‡å®šæµ‹è¯•ç±»çš„æ‰§è¡Œé¡ºåº</td>
</tr>
<tr>
<td>@TestMethodOrder</td>
<td>æŒ‡å®šæµ‹è¯•æ–¹æ³•çš„æ‰§è¡Œé¡ºåº</td>
</tr>
<tr>
<td>@ExtendWith</td>
<td>ä¸ºæµ‹è¯•ç±»æˆ–æµ‹è¯•æ–¹æ³•ç”šè‡³å­—æ®µæä¾›ä¸€ä¸ªæˆ–å¤šä¸ªæ‰©å±•ç¯å¢ƒ</td>
</tr>
</tbody>
</table>
<h3 id="h_2-2">2.2. æ–°çš„ç‰¹æ€§</h3>
<h4 id="h_2-2-1">2.2.1. è¶…æ—¶æ–­è¨€</h4>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@Test</span>
<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;è¶…æ—¶æµ‹è¯•&quot;</span><span class="p">)</span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">timeoutTest</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">//å¦‚æœæµ‹è¯•æ–¹æ³•æ—¶é—´è¶…è¿‡1så°†ä¼šå¼‚å¸¸</span>
<span class="w">    </span><span class="n">Assertions</span><span class="p">.</span><span class="na">assertTimeout</span><span class="p">(</span><span class="n">Duration</span><span class="p">.</span><span class="na">ofMillis</span><span class="p">(</span><span class="mi">1000</span><span class="p">),</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>


</div>

<h4 id="h_2-2-2">2.2.2. å‚æ•°åŒ–æµ‹è¯•</h4>
<p>ä»¥ä¸‹ä¸ºéƒ¨åˆ†ä»‹ç»,æ›´å¤šç»†èŠ‚<a href="https://junit.org/junit5/docs/current/user-guide/#writing-tests-parameterized-tests" class="external-link">åœ¨è¿™å„¿</a>.   </p>
<h5 id="h_2-2-2-1">2.2.2.1. ä¼ å…¥å•ä¸ªå‚æ•°</h5>
<ul>
<li>
<p>@ValueSource: ä¸ºå‚æ•°åŒ–æµ‹è¯•æŒ‡å®šå…¥å‚æ¥æºï¼Œæ”¯æŒå…«å¤§åŸºç¡€ç±»ä»¥åŠ String ç±»å‹, Class ç±»å‹   </p>
</li>
<li>
<p>@EmptySource: æä¾›ç©ºç™½æ•°ç»„æˆ–ç©ºç™½é›†åˆ,æ”¯æŒå…«å¤§åŸºç¡€ç±»åŠå®ƒä»¬åŒ…è£…ç±»ä»¥åŠ String ç±»å‹, é›†åˆç±»å‹   </p>
</li>
<li>
<p>@NullSource: è¡¨ç¤ºä¸ºå‚æ•°åŒ–æµ‹è¯•æä¾›ä¸€ä¸ª null çš„å…¥å‚   </p>
</li>
<li>
<p>@EnumSource: è¡¨ç¤ºä¸ºå‚æ•°åŒ–æµ‹è¯•æä¾›ä¸€ä¸ªæšä¸¾å…¥å‚   </p>
</li>
</ul>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot;racecar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;radar&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;able was I ere I saw elba&quot;</span><span class="w"> </span><span class="p">})</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">palindromes</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">candidate</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">StringUtils</span><span class="p">.</span><span class="na">isPalindrome</span><span class="p">(</span><span class="n">candidate</span><span class="p">));</span>
<span class="p">}</span>
</code></pre></div>


</div>

<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@NullSource</span>
<span class="nd">@EmptySource</span>
<span class="nd">@ValueSource</span><span class="p">(</span><span class="n">strings</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="s">&quot; &quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;   &quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\t&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;\n&quot;</span><span class="w"> </span><span class="p">})</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">nullEmptyAndBlankStrings</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">text</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">text</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="w"> </span><span class="o">||</span><span class="w"> </span><span class="n">text</span><span class="p">.</span><span class="na">trim</span><span class="p">().</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="p">}</span>
</code></pre></div>


</div>

<h5 id="h_2-2-2-2">2.2.2.2. ä¼ å…¥å¤šä¸ªå‚æ•°</h5>
<ul>
<li>@MethodSourceï¼šè¯»å–é™æ€æ–¹æ³•çš„Streamæµä½œä¸ºå‚æ•°åŒ–æµ‹è¯•å…¥å‚   </li>
</ul>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@MethodSource</span><span class="p">(</span><span class="s">&quot;stringIntAndListProvider&quot;</span><span class="p">)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">testWithMultiArgMethodSource</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">str</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">num</span><span class="p">,</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">String</span><span class="o">&gt;</span><span class="w"> </span><span class="n">list</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span><span class="w"> </span><span class="n">str</span><span class="p">.</span><span class="na">length</span><span class="p">());</span>
<span class="w">    </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">num</span><span class="w"> </span><span class="o">&gt;=</span><span class="mi">1</span><span class="w"> </span><span class="o">&amp;&amp;</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="o">&lt;=</span><span class="mi">2</span><span class="p">);</span>
<span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">list</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="p">}</span>

<span class="kd">static</span><span class="w"> </span><span class="n">Stream</span><span class="o">&lt;</span><span class="n">Arguments</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">stringIntAndListProvider</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span>
<span class="w">        </span><span class="n">arguments</span><span class="p">(</span><span class="s">&quot;apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;a&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;b&quot;</span><span class="p">)),</span>
<span class="w">        </span><span class="n">arguments</span><span class="p">(</span><span class="s">&quot;lemon&quot;</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Arrays</span><span class="p">.</span><span class="na">asList</span><span class="p">(</span><span class="s">&quot;x&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;y&quot;</span><span class="p">))</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>


</div>

<ul>
<li>@ArgumentsSource: è¯»å–å®ç°äº†ArgumentsProvideræ¥å£çš„ç±»ä¸­æ–¹æ³•è¿”å›æµä½œä¸ºå…¥å‚   </li>
</ul>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@ArgumentsSource</span><span class="p">(</span><span class="n">MyArgumentsProvider</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">testWithArgumentsSource</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">argument</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assertNotNull</span><span class="p">(</span><span class="n">argument</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">MyArgumentsProvider</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ArgumentsProvider</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Stream</span><span class="o">&lt;?</span><span class="w"> </span><span class="kd">extends</span><span class="w"> </span><span class="n">Arguments</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">provideArguments</span><span class="p">(</span><span class="n">ExtensionContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">Stream</span><span class="p">.</span><span class="na">of</span><span class="p">(</span><span class="s">&quot;apple&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;banana&quot;</span><span class="p">).</span><span class="na">map</span><span class="p">(</span><span class="n">Arguments</span><span class="p">::</span><span class="n">of</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


</div>

<h5 id="h_2-2-2-3">2.2.2.3. ä¼ å…¥å¯¹è±¡&amp;å¤§é‡æ•°æ®(æ–‡ä»¶)</h5>
<ul>
<li>@CsvSourceï¼šè¡¨ç¤ºè¯»å–æŒ‡å®š CSVå†…å®¹ä½œä¸ºå‚æ•°åŒ–æµ‹è¯•å…¥å‚   </li>
</ul>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvSource</span><span class="p">({</span>
<span class="w">    </span><span class="s">&quot;Jane, Doe, F, 1990-05-20&quot;</span><span class="p">,</span>
<span class="w">    </span><span class="s">&quot;John, Doe, M, 1990-10-22&quot;</span>
<span class="p">})</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">testWithArgumentsAggregator</span><span class="p">(</span><span class="nd">@AggregateWith</span><span class="p">(</span><span class="n">PersonAggregator</span><span class="p">.</span><span class="na">class</span><span class="p">)</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="n">person</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="c1">// perform assertions against person</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="kd">class</span> <span class="nc">PersonAggregator</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">ArgumentsAggregator</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="nd">@Override</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="n">Person</span><span class="w"> </span><span class="nf">aggregateArguments</span><span class="p">(</span><span class="n">ArgumentsAccessor</span><span class="w"> </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="n">ParameterContext</span><span class="w"> </span><span class="n">context</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Person</span><span class="p">(</span><span class="n">arguments</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">0</span><span class="p">),</span>
<span class="w">                          </span><span class="n">arguments</span><span class="p">.</span><span class="na">getString</span><span class="p">(</span><span class="mi">1</span><span class="p">),</span>
<span class="w">                          </span><span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">Gender</span><span class="p">.</span><span class="na">class</span><span class="p">),</span>
<span class="w">                          </span><span class="n">arguments</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">LocalDate</span><span class="p">.</span><span class="na">class</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


</div>

<ul>
<li>@CsvFileSourceï¼šè¡¨ç¤ºè¯»å–æŒ‡å®š CSV æ–‡ä»¶å†…å®¹ä½œä¸ºå‚æ•°åŒ–æµ‹è¯•å…¥å‚   </li>
</ul>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="nd">@ParameterizedTest</span>
<span class="nd">@CsvFileSource</span><span class="p">(</span><span class="n">resources</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/two-column.csv&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">numLinesToSkip</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">)</span>
<span class="kt">void</span><span class="w"> </span><span class="nf">testWithCsvFileSourceFromClasspath</span><span class="p">(</span><span class="n">String</span><span class="w"> </span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="w"> </span><span class="n">output</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">assertNotNull</span><span class="p">(</span><span class="n">input</span><span class="p">);</span>
<span class="w">    </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">input</span><span class="p">,</span><span class="w"> </span><span class="n">output</span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>


</div>

<h5 id="h_2-2-2-4">2.2.2.4. æ‰©å±•</h5>
<ol>
<li>
<p>å‚æ•°åŒ–æµ‹è¯•ç›¸å½“äºæ˜¯åˆå¹¶äº†å¤šä¸ªå•å…ƒæµ‹è¯•è¾“å…¥è¾“å‡ºæ•°æ®çš„"ç¼©å†™",æ‰€ä»¥é€šå¸¸ä¼šæœ‰ä»£è¡¨inputå’Œoutputçš„è¾“å…¥è¾“å‡º.å½“inputéƒ½å¯¹åº”ç›¸åŒçš„outputæ—¶,å¯ä»¥çœç•¥output.   </p>
</li>
<li>
<p>é€šè¿‡å¤–éƒ¨æ–‡ä»¶ä½œä¸ºå‚æ•°æ„é€ æ–‡ä»¶,å°±å¯ä»¥<strong>å°†æµ‹è¯•é€»è¾‘ä¸å‡†å¤‡æ•°æ®å……åˆ†è§£è€¦</strong>.å…·ä½“å®ç°é™¤äº†å®˜æ–¹æ”¯æŒçš„CSV ,æƒ³æ”¯æŒå…¶ä»–æ ¼å¼,å¦‚JSON/YAML   </p>
<ol>
<li>å¯ä»¥è½¬æˆå¯¹åº”çš„CSV   </li>
<li>è‡ªå·±ä»æ–‡ä»¶è·¯å¾„ä¸­è¯»å–æ–‡ä»¶,å†è½¬æˆStream,é€šè¿‡<code>@MethodSource</code>æˆ–<code>@ArgumentsSource</code>å®ç°å…¥å‚   </li>
</ol>
</li>
</ol>
<p>ç¬¬äºŒç§æ€è·¯é€‚ç”¨æ€§æ›´å¼ºï¼Œå¯å‚è€ƒ<a href="https://github.com/istarwyh/TestMuseum/blob/main/tdd.java.common/src/main/java/istarwyh/junit5/annotation/JsonFileSource.java" class="external-link">ç¬”è€…çš„å®ç°</a>ã€‚   </p>
<h4 id="h_2-2-3">2.2.3. é‡å¤ä¸å¹¶å‘æµ‹è¯•</h4>
<h5 id="h_2-2-3-1">2.2.3.1. é‡å¤æµ‹è¯•</h5>
<p>æœ‰äººå¯èƒ½ä¼šç–‘æƒ‘ä»€ä¹ˆæ—¶å€™èƒ½ç”¨ä¸Šé‡å¤æµ‹è¯•?ä¸€ç§æƒ…å†µæ˜¯å½“æ–¹æ³•é‡å¤æ‰§è¡Œè¾“å‡ºæˆ–è€…å‡½æ•°å‰¯ä½œç”¨ä¸åŒæ—¶,æ¯”å¦‚ç»Ÿè®¡å¹¶å‘å¼‚æ­¥æ‰§è¡Œçš„æ–¹æ³•æœ€ç»ˆè€—æ—¶:   </p>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="kd">class</span> <span class="nc">ParallelTest</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">sleep200</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">run</span><span class="p">(</span><span class="n">sleep</span><span class="p">(</span><span class="mi">200</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">sleep300</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">run</span><span class="p">(</span><span class="n">sleep</span><span class="p">(</span><span class="mi">300</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">sleep500</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">run</span><span class="p">(</span><span class="n">sleep</span><span class="p">(</span><span class="mi">500</span><span class="p">));</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="n">Runnable</span><span class="w"> </span><span class="nf">sleep</span><span class="p">(</span><span class="kt">int</span><span class="w"> </span><span class="n">during</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="p">()</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">Thread</span><span class="p">.</span><span class="na">sleep</span><span class="p">(</span><span class="n">during</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">};</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">run</span><span class="p">(</span><span class="n">Runnable</span><span class="w"> </span><span class="n">runnable</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">Instant</span><span class="w"> </span><span class="n">start</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Instant</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<span class="w">        </span><span class="n">runnable</span><span class="p">.</span><span class="na">run</span><span class="p">();</span>
<span class="w">        </span><span class="n">Instant</span><span class="w"> </span><span class="n">end</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Instant</span><span class="p">.</span><span class="na">now</span><span class="p">();</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">Thread</span><span class="p">.</span><span class="na">currentThread</span><span class="p">().</span><span class="na">getName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; ------------------------ &quot;</span><span class="w"> </span><span class="o">+</span>
<span class="w">                </span><span class="s">&quot;I have run &quot;</span><span class="o">+</span><span class="w"> </span><span class="n">Duration</span><span class="p">.</span><span class="na">between</span><span class="p">(</span><span class="n">start</span><span class="p">,</span><span class="n">end</span><span class="p">).</span><span class="na">toMillis</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot; ms&quot;</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="kd">private</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">async</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">run</span><span class="p">(()</span><span class="o">-&gt;</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="k">try</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">allOf</span><span class="p">(</span><span class="n">runAsync</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">sleep200</span><span class="p">),</span><span class="w"> </span><span class="n">runAsync</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">sleep300</span><span class="p">),</span><span class="w"> </span><span class="n">runAsync</span><span class="p">(</span><span class="k">this</span><span class="p">::</span><span class="n">sleep500</span><span class="p">)).</span><span class="na">get</span><span class="p">();</span>
<span class="w">            </span><span class="p">}</span><span class="w"> </span><span class="k">catch</span><span class="w"> </span><span class="p">(</span><span class="n">InterruptedException</span><span class="w"> </span><span class="o">|</span><span class="w"> </span><span class="n">ExecutionException</span><span class="w"> </span><span class="n">e</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="s">&quot;&quot;</span><span class="o">+</span><span class="n">e</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">});</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@RepeatedTest</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="nd">@Execution</span><span class="p">(</span><span class="n">ExecutionMode</span><span class="p">.</span><span class="na">SAME_THREAD</span><span class="p">)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">testAsyncWithSameMethod</span><span class="p">(</span><span class="n">TestInfo</span><span class="w"> </span><span class="n">testInfo</span><span class="p">){</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">testInfo</span><span class="p">.</span><span class="na">getTestMethod</span><span class="p">().</span><span class="na">get</span><span class="p">().</span><span class="na">getName</span><span class="p">());</span>
<span class="w">        </span><span class="n">async</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="p">}</span>
</code></pre></div>


</div>

<p><img alt="" src="https://xiaohui-zhangjiakou.oss-cn-zhangjiakou.aliyuncs.com/image/202309091453982.png" />   </p>
<h5 id="h_2-2-3-2">2.2.3.2. å¹¶å‘æµ‹è¯•</h5>
<p>å¹¶å‘æµ‹è¯•å¾ˆé€‚åˆæµ‹è¯•ä¸‹æ¸¸å¹‚ç­‰ã€‚JUnit5ä¸­çš„å¹¶å‘æ‰§è¡Œæµ‹è¯•å¯ä»¥åˆ†ä¸ºä»¥ä¸‹ä¸‰ç§åœºæ™¯ï¼š   </p>
<ul>
<li>å¤šä¸ªæµ‹è¯•ç±»ï¼Œå®ƒä»¬å„è‡ªçš„æµ‹è¯•æ–¹æ³•åŒæ—¶æ‰§è¡Œï¼›   </li>
<li>ä¸€ä¸ªæµ‹è¯•ç±»ï¼Œé‡Œé¢çš„å¤šä¸ªæµ‹è¯•æ–¹æ³•åŒæ—¶æ‰§è¡Œï¼›   </li>
<li>ä¸€ä¸ªæµ‹è¯•ç±»ï¼Œé‡Œé¢çš„ä¸€ä¸ªæµ‹è¯•æ–¹æ³•ï¼Œåœ¨é‡å¤æµ‹è¯•(Repeated Tests)æˆ–è€…å‚æ•°åŒ–æµ‹è¯•(Parameterized Tests)çš„æ—¶å€™ï¼Œè¿™ä¸ªæµ‹è¯•æ–¹æ³•è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼›   </li>
</ul>
<p>ä»¥æœ€åä¸€ç§åŒä¸€ä¸ªç±»åŒä¸€ä¸ªæ–¹æ³•å¤šæ¬¡æ‰§è¡Œçš„å¹¶å‘ä¸ºä¾‹,éœ€è¦åœ¨test/resourcesç›®å½•ä¸­åŠ å…¥<code>junit-platform.properties</code>:   </p>
<div class="lang-properties">

<div class="codehilite"><pre><span></span><code><span class="c1"># å¹¶è¡Œå¼€å…³true/false</span>
<span class="na">junit.jupiter.execution.parallel.enabled</span><span class="o">=</span><span class="s">true</span>
<span class="c1"># æ–¹æ³•çº§å¤šçº¿ç¨‹å¼€å…³ same_thread/concurrent</span>
<span class="na">junit.jupiter.execution.parallel.mode.default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">same_thread</span>
<span class="c1"># ç±»çº§å¤šçº¿ç¨‹å¼€å…³ same_thread/concurrent</span>
<span class="na">junit.jupiter.execution.parallel.mode.classes.default</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">same_thread</span>

<span class="c1"># å¹¶å‘ç­–ç•¥æœ‰ä»¥ä¸‹ä¸‰ç§å¯é€‰ï¼š</span>
<span class="c1"># fixedï¼šå›ºå®šçº¿ç¨‹æ•°ï¼Œæ­¤æ—¶è¿˜è¦é€šè¿‡junit.jupiter.execution.parallel.config.fixed.parallelismæŒ‡å®šçº¿ç¨‹æ•°</span>
<span class="c1"># dynamicï¼šè¡¨ç¤ºæ ¹æ®å¤„ç†å™¨å’Œæ ¸æ•°è®¡ç®—çº¿ç¨‹æ•°</span>
<span class="c1"># customï¼šè‡ªå®šä¹‰å¹¶å‘ç­–ç•¥ï¼Œé€šè¿‡è¿™ä¸ªé…ç½®æ¥æŒ‡å®šï¼šjunit.jupiter.execution.parallel.config.custom.class</span>
<span class="na">junit.jupiter.execution.parallel.config.strategy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">fixed</span>

<span class="c1"># å¹¶å‘çº¿ç¨‹æ•°ï¼Œè¯¥é…ç½®é¡¹åªæœ‰å½“å¹¶å‘ç­–ç•¥ä¸ºfixedçš„æ—¶å€™æ‰æœ‰ç”¨</span>
<span class="na">junit.jupiter.execution.parallel.config.fixed.parallelism</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">5</span>
</code></pre></div>


</div>

<p>ç„¶åå†åŸæœ¬æµ‹è¯•ä»£ç æ ‡è®°<code>@Execution(ExecutionMode.CONCURRENT)</code>:   </p>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nd">@RepeatedTest</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span><span class="w"> </span><span class="nd">@Execution</span><span class="p">(</span><span class="n">ExecutionMode</span><span class="p">.</span><span class="na">CONCURRENT</span><span class="p">)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">testAsyncConcurrently</span><span class="p">(</span><span class="n">TestInfo</span><span class="w"> </span><span class="n">testInfo</span><span class="p">){</span>
<span class="w">        </span><span class="n">System</span><span class="p">.</span><span class="na">out</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">testInfo</span><span class="p">.</span><span class="na">getTestMethod</span><span class="p">().</span><span class="na">get</span><span class="p">().</span><span class="na">getName</span><span class="p">());</span>
<span class="w">        </span><span class="n">async</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>


</div>

<p><img alt="" src="https://xiaohui-zhangjiakou.oss-cn-zhangjiakou.aliyuncs.com/image/202309091501237.png" />   </p>
<p>å¯¹æ¯”ä¹‹å‰çš„ç»“æœ,å¯ä»¥çœ‹åˆ°æ‰§è¡Œçš„ä¹±åºä»¥åŠæœ€å¼€å§‹ç¡®å®æœ‰é—®é¢˜5ä¸ªçº¿ç¨‹å¹¶å‘æ‰§è¡Œäº†è¿™ä¸ªæ–¹æ³•,æœ€åæ€»æ—¶é—´1815msä¹Ÿæ¯”èµ·æ¥500*5msç•¥å°‘ä¸€äº›.   </p>
<h4 id="h_2-2-4">2.2.4. å¯¹ç±»ä¸­å•å…ƒæµ‹è¯•åˆ†ç»„</h4>
<p>å¦‚æœä¸€ä¸ªServiceç±»ä¸­æ–¹æ³•è¾ƒå¤š,å•çº¯å†™å•å…ƒæµ‹è¯•ä¹Ÿä¼šå¾ˆå¤š.@Nested å¯ä»¥å…è®¸ä»¥é™æ€å†…éƒ¨æˆå‘˜ç±»çš„å½¢å¼å¯¹æµ‹è¯•ç”¨ä¾‹ç±»è¿›è¡Œé€»è¾‘åˆ†ç»„.\ <br />
ä¸‹é¢æ˜¯ä¸€ä¸ªæµ‹è¯•StackåŠŸèƒ½çš„ä¾‹å­   </p>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertEquals</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertFalse</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertThrows</span><span class="p">;</span>
<span class="kn">import static</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Assertions.assertTrue</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.EmptyStackException</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">java.util.Stack</span><span class="p">;</span>

<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.BeforeEach</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.DisplayName</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Nested</span><span class="p">;</span>
<span class="kn">import</span><span class="w"> </span><span class="nn">org.junit.jupiter.api.Test</span><span class="p">;</span>

<span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;A stack&quot;</span><span class="p">)</span>
<span class="kd">class</span> <span class="nc">TestingAStackDemo</span><span class="w"> </span><span class="p">{</span>

<span class="w">    </span><span class="n">Stack</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="w"> </span><span class="n">stack</span><span class="p">;</span>

<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;is instantiated with new Stack()&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kt">void</span><span class="w"> </span><span class="nf">isInstantiatedWithNew</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">Stack</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Nested</span>
<span class="w">    </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;when new&quot;</span><span class="p">)</span>
<span class="w">    </span><span class="kd">class</span> <span class="nc">WhenNew</span><span class="w"> </span><span class="p">{</span>

<span class="w">        </span><span class="nd">@BeforeEach</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">createNewStack</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">stack</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">Stack</span><span class="o">&lt;&gt;</span><span class="p">();</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;is empty&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">isEmpty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;throws EmptyStackException when popped&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">throwsExceptionWhenPopped</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertThrows</span><span class="p">(</span><span class="n">EmptyStackException</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">stack</span><span class="p">::</span><span class="n">pop</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Test</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;throws EmptyStackException when peeked&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kt">void</span><span class="w"> </span><span class="nf">throwsExceptionWhenPeeked</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="n">assertThrows</span><span class="p">(</span><span class="n">EmptyStackException</span><span class="p">.</span><span class="na">class</span><span class="p">,</span><span class="w"> </span><span class="n">stack</span><span class="p">::</span><span class="n">peek</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span>

<span class="w">        </span><span class="nd">@Nested</span>
<span class="w">        </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;after pushing an element&quot;</span><span class="p">)</span>
<span class="w">        </span><span class="kd">class</span> <span class="nc">AfterPushing</span><span class="w"> </span><span class="p">{</span>

<span class="w">            </span><span class="n">String</span><span class="w"> </span><span class="n">anElement</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;an element&quot;</span><span class="p">;</span>

<span class="w">            </span><span class="nd">@BeforeEach</span>
<span class="w">            </span><span class="kt">void</span><span class="w"> </span><span class="nf">pushAnElement</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">stack</span><span class="p">.</span><span class="na">push</span><span class="p">(</span><span class="n">anElement</span><span class="p">);</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Test</span>
<span class="w">            </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;it is no longer empty&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="kt">void</span><span class="w"> </span><span class="nf">isNotEmpty</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">assertFalse</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Test</span>
<span class="w">            </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;returns the element when popped and is empty&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="kt">void</span><span class="w"> </span><span class="nf">returnElementWhenPopped</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">anElement</span><span class="p">,</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="na">pop</span><span class="p">());</span>
<span class="w">                </span><span class="n">assertTrue</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>

<span class="w">            </span><span class="nd">@Test</span>
<span class="w">            </span><span class="nd">@DisplayName</span><span class="p">(</span><span class="s">&quot;returns the element when peeked but remains not empty&quot;</span><span class="p">)</span>
<span class="w">            </span><span class="kt">void</span><span class="w"> </span><span class="nf">returnElementWhenPeeked</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">                </span><span class="n">assertEquals</span><span class="p">(</span><span class="n">anElement</span><span class="p">,</span><span class="w"> </span><span class="n">stack</span><span class="p">.</span><span class="na">peek</span><span class="p">());</span>
<span class="w">                </span><span class="n">assertFalse</span><span class="p">(</span><span class="n">stack</span><span class="p">.</span><span class="na">isEmpty</span><span class="p">());</span>
<span class="w">            </span><span class="p">}</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


</div>

<p><img alt="" src="https://junit.org/junit5/docs/current/user-guide/images/writing-tests_nested_test_ide.png" />   </p>
<h3 id="h_2-3-junit5">2.3. JUnit5åŸç†</h3>
<p>å•ç‹¬çš„JUnit5å…¶å®æ˜¯éš¾ä»¥ä½¿ç”¨çš„,é€šå¸¸IDEæˆ–è€…ä»£ç ç®¡ç†å·¥å…·,æ¯”å¦‚IntelliJ IDEA, Eclipse, NetBeans, Visual Studio Code, Gradle, Mavenéƒ½ä¼šå¯¹JUnit5è¿›è¡Œé›†æˆ,ä»è€Œè®©æµ‹è¯•å¯¹å¼€å‘æ›´å‹å¥½.æ‰€ä»¥ä»¥IDEA+JUnit5ä¸ºä¾‹,ç¬¬ä¸€æ­¥å…¶å®æ˜¯ä»IDEA<a href="https://github.com/JetBrains/intellij-community/tree/61fb94acd0e337972338618b58c38a4509aefcff/plugins/junit5_rt/src/com/intellij/junit5" class="external-link">å†…éƒ¨æ’ä»¶</a>ä»£ç å¼€å§‹çš„.   </p>
<ol>
<li>è§¦å‘æµ‹è¯•è¿›å…¥æ’ä»¶æºç ,com.intellij.rt.junit.JUnitStarter::main   </li>
<li>IDEAæ„é€ DefaultDiscoveryRequestå¯¹è±¡ä¼ å…¥org.junit.platform.launcher.core::execute   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="cm">/**</span>
<span class="cm"> * {@code DefaultDiscoveryRequest} is the default implementation of the</span>
<span class="cm"> * {@link EngineDiscoveryRequest} and {@link LauncherDiscoveryRequest} APIs.</span>
<span class="cm"> *</span>
<span class="cm"> * @since 1.0</span>
<span class="cm"> */</span>
<span class="kd">final</span><span class="w"> </span><span class="kd">class</span> <span class="nc">DefaultDiscoveryRequest</span><span class="w"> </span><span class="kd">implements</span><span class="w"> </span><span class="n">LauncherDiscoveryRequest</span><span class="w"> </span><span class="p">{</span>

<span class="w">  </span><span class="c1">// Selectors provided to the engines to be used for discovering tests</span>
<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">DiscoverySelector</span><span class="o">&gt;</span><span class="w"> </span><span class="n">selectors</span><span class="p">;</span>

<span class="w">  </span><span class="c1">// Discovery filters are handed through to all engines to be applied during discovery.</span>
<span class="w">  </span><span class="kd">private</span><span class="w"> </span><span class="kd">final</span><span class="w"> </span><span class="n">List</span><span class="o">&lt;</span><span class="n">DiscoveryFilter</span><span class="o">&lt;?&gt;&gt;</span><span class="w"> </span><span class="n">discoveryFilters</span><span class="p">;</span>

<span class="w">  </span><span class="p">}</span>
</code></pre></div>


</div>

<ol>
<li>
<p>è§£ææµ‹è¯•ç”¨ä¾‹ç”Ÿæˆæµ‹è¯•è®¡åˆ’   </p>
</li>
<li>
<p><img alt="" src="https://gitee.com/istarwyh/images/raw/master/vnote/ç¨‹åºå‘˜ç»ƒçº§ä¹‹è·¯/å·¥ç¨‹å®è·µ/æµ‹è¯•/junit5&amp;mockito.md/492251015238973.png" />   </p>
</li>
<li>
<p>é€‰æ‹©å…·ä½“çš„æµ‹è¯•å¼•æ“æ‰§è¡Œç”¨ä¾‹,ä»¥JupiterTestEngineä¸ºä¾‹,ä¼šæ„é€ JupiterEngineDescriptor   </p>
</li>
<li>
<p><img alt="" src="https://gitee.com/istarwyh/images/raw/master/vnote/ç¨‹åºå‘˜ç»ƒçº§ä¹‹è·¯/å·¥ç¨‹å®è·µ/æµ‹è¯•/junit5&amp;mockito.md/90941715226840.png" />   </p>
</li>
<li>
<p>ç”ŸæˆNodeTeskTaskç„¶åäº¤ç»™ExecutorServiceå»æ‰§è¡Œ(åå°„è°ƒç”¨å…·ä½“æ–¹æ³•)   </p>
</li>
<li>å®é™…æ‰§è¡Œæ—¶ä¼šæ ¹æ®æ³¨è§£å…ˆå»æ‰¾å®ç°çš„æ‰©å±•ç±»,æ¯”å¦‚å¯åŠ¨Springæ—¶çš„SpringExtensionã€Mockä¾èµ–çš„ MockitoExtension   </li>
</ol>
<h2 id="h_3-mockito">3. Mockitoä½¿ç”¨ä¸åŸç†</h2>
<h3 id="h_3-1">3.1. å¸¸ç”¨æ³¨è§£</h3>
<h4 id="h_3-1-1">3.1.1. ä»‹ç»</h4>
<table>
<thead>
<tr>
<th>Annotation</th>
<th>æè¿°</th>
</tr>
</thead>
<tbody>
<tr>
<td>@Mock</td>
<td>@Mockä¿®é¥°çš„å¯¹è±¡éƒ½æ˜¯null,ç”¨åˆ°çš„æ¯ä¸ªæ–¹æ³•éƒ½éœ€è¦æ‰“æ¡©æ¨¡æ‹Ÿæ‰§è¡Œç»“æœ: Mockito.when().thenReturn()</td>
</tr>
<tr>
<td>@Spy</td>
<td>@Spyçš„å¯¹è±¡ä¼šè¢«æ— å‚å®ä¾‹åŒ–,åœ¨éœ€è¦çš„æ—¶å€™å¯ä»¥æ‰“æ¡©æ¨¡æ‹Ÿæ‰§è¡Œç»“æœ: Mockito.doReturn().when()</td>
</tr>
<tr>
<td>@MockBean</td>
<td>å¯åŠ¨Springå®¹å™¨,æ›¿æ¢SpringåŸæœ¬åŠ è½½çš„Bean,ä½†æ˜¯é»˜è®¤å¯¹è±¡æ²¡æœ‰è¡Œä¸º</td>
</tr>
<tr>
<td>@SpyBean</td>
<td>å¯åŠ¨Springå®¹å™¨,æ›¿æ¢SpringåŸæœ¬åŠ è½½çš„Bean,å¯¹è±¡æ‹¥æœ‰é»˜è®¤è¡Œä¸º</td>
</tr>
<tr>
<td>@InjectMocks</td>
<td>æ³¨å…¥mockä»£ç†å¯¹è±¡;å¿…é¡»ä¿®é¥°å®ç°ç±»,ä¿®é¥°æ¥å£ä¼šæŠ¥é”™</td>
</tr>
<tr>
<td>@Captor</td>
<td>é…åˆverifyåœ¨æ–¹æ³•è°ƒç”¨åä½¿ç”¨ï¼Œæ•è·è°ƒç”¨æ—¶çš„å‚æ•°å€¼</td>
</tr>
</tbody>
</table>
<p>å…¶ä»–è¯´æ˜:   </p>
<ol>
<li>
<p><span class="formatting_strikethrough">ä½¿ç”¨<code>@Spy</code>çš„å‰ææ˜¯å¯¹è±¡å¯ä»¥è¢«ä½¿ç”¨æ— å‚æ„é€ å™¨åˆå§‹åŒ–,</span><span class="formatting_strikethrough">å› ä¸ºéœ€è¦å¾—åˆ°ä¸€ä¸ªç©ºå¯¹è±¡ç„¶åæ¥æ‰§è¡Œå®ƒçš„æ–¹æ³•</span>.   </p>
</li>
<li>
<p><code>@Spy</code> å’Œ<code>@InjectMocks</code>å¯ä»¥æ­é…ä½¿ç”¨,ä»è€Œå…è®¸éªŒè¯å½“å‰Spyå¯¹è±¡ä¸­è¢«mockçš„å±æ€§çš„è¡Œä¸º,æŸäº›æƒ…å†µä¸‹é€‚åˆåœ¨controller/service/daoåˆ†çš„serviceç‰¹åˆ«å•è–„æ—¶,åœ¨controllerå±‚å¯¹daoå±‚æ–¹æ³•ä¸­çš„è¡Œä¸ºè¿›è¡ŒéªŒè¯,ä½†å¿…é¡»æ³¨æ„è¿™è¿åäº†å•ä¸€èŒè´£åŸåˆ™(SRPåŸåˆ™)   </p>
</li>
<li><code>@Spy</code> ä¿®é¥°æ¥å£ä¸ä¼šæŠ¥é”™,ä¸è¿‡å› ä¸ºæ¥å£æ²¡æœ‰å®ç°é€»è¾‘,æ‰€ä»¥ä¸æ‰“æ¡©æ¨¡æ‹Ÿçš„æ—¶å€™,æ¥å£æ–¹æ³•æ°¸è¿œè¿”å›<code>null</code>ã€‚   </li>
</ol>
<p>@Spy ä¸ @Mock æµ‹è¯•æ¡ˆä¾‹:   </p>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">whenCreateMock_thenCreated</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="w"> </span><span class="n">mockedList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mockito</span><span class="p">.</span><span class="na">mock</span><span class="p">(</span><span class="n">ArrayList</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>

<span class="w">        </span><span class="n">mockedList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">Mockito</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="n">mockedList</span><span class="p">).</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">mockedList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>

<span class="w">    </span><span class="nd">@Test</span>
<span class="w">    </span><span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">whenCreateSpy_thenCreate</span><span class="p">()</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="n">List</span><span class="w"> </span><span class="n">spyList</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Mockito</span><span class="p">.</span><span class="na">spy</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">ArrayList</span><span class="p">());</span>

<span class="w">        </span><span class="n">spyList</span><span class="p">.</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">);</span>
<span class="w">        </span><span class="n">Mockito</span><span class="p">.</span><span class="na">verify</span><span class="p">(</span><span class="n">spyList</span><span class="p">).</span><span class="na">add</span><span class="p">(</span><span class="s">&quot;one&quot;</span><span class="p">);</span>

<span class="w">        </span><span class="n">assertEquals</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">spyList</span><span class="p">.</span><span class="na">size</span><span class="p">());</span>
<span class="w">    </span><span class="p">}</span>
</code></pre></div>


</div>

<h4 id="h_3-1-2">3.1.2. ä½¿ç”¨å»ºè®®</h4>
<h5 id="h_3-1-2-1">3.1.2.1. æ³¨è§£å¸¸ç”¨å®è·µ</h5>
<ol>
<li>ä¸€èˆ¬æ¥è¯´,<code>@Spy</code>ä¿®é¥°å®ç°ç±»ã€<code>@InjectMocks</code>ä¿®é¥°éœ€è¦mockå±æ€§çš„å®ç°ç±»ã€<code>@Mock</code>ä¿®é¥°æ¥å£   </li>
<li>é»˜è®¤ä½¿ç”¨<code>@Spy</code>æˆ–<code>@SpyBean</code>,æœ‰éœ€è¦æ‰“æ¡©æ¨¡æ‹Ÿè¿”å›ç»“æœçš„æƒ…å†µå¯ä»¥è‡ªå®šä¹‰æ¨¡æ‹Ÿè¿”å›ç»“æœ,å°½å¯èƒ½çš„è¦†ç›–æ›´å¤šçš„ä»£ç é€»è¾‘   </li>
<li>å¯¹æ— æ³•ç›´æ¥å®ä¾‹åŒ–çš„ä¸‰æ–¹ä¾èµ–,æ¯”å¦‚ä¸‹æ¸¸æ¥å£ã€Redisç­‰ä½¿ç”¨<code>@Mock</code>;æ²¡æœ‰Mockåˆ°çš„ä¾èµ–ä¼šNPE,é€ä¸ªMockå³å¯   </li>
<li>
<p>æ£€æŸ¥<code>void</code>æ–¹æ³•çš„æ‰§è¡Œæƒ…å†µå¯ä»¥ä½¿ç”¨<code>verify/times</code>æ ¡éªŒè°ƒç”¨æ¬¡æ•°å’Œ<code>@Captor</code>æ£€æŸ¥è°ƒç”¨å‚æ•°æ¥è¿›è¡Œ<strong>è¡Œä¸ºéªŒè¯</strong>   </p>
</li>
<li>
<p>æ­£å¦‚å‰è¨€ä¸­æåˆ°çš„,ä½¿ç”¨è¿™ç§æµ‹è¯•æ¡†æ¶æœ€éº»çƒ¦çš„åœ¨äºçœŸå®ç”Ÿäº§ä»£ç ä¸­æµ‹è¯•ç”¨ä¾‹ä¸­å¤æ‚å¯¹è±¡çš„æ„é€    </p>
</li>
<li>
<p>é“¾è·¯å½•åˆ¶å·¥å…·å¯ä»¥å¸®åŠ©ç”Ÿæˆè¯·æ±‚ä¸è¿”å›ç»“æ„ä½“,æ¯”å¦‚ä½¿ç”¨AOPæ‹¦æˆªRPCè¯·æ±‚å¾—åˆ°å…¥å‚å’Œå‡ºå‚   </p>
</li>
</ol>
<h5 id="h_3-1-2-2-mockito-patterns">3.1.2.2. <a href="https://stackoverflow.com/questions/11462697/forming-mockito-grammars" class="external-link">Mockito Patterns</a>:</h5>
<blockquote>
<p>When/Then: when(yourMethod()).thenReturn(x); <br />
Do/When: doReturn(x).when(yourMock.fizzBuzz()); <br />
Verify/Do: verify(yourMethod()).doThrow(SomeException.class);   </p>
</blockquote>
<p>å…¶ä¸­<code>when/then</code>ä»¥åŠ<code>doxxx/when</code>ç›¸ä¼¼åº¦å¾ˆé«˜,å¾ˆå¤šäººä¼šç–‘æƒ‘<a href="https://stackoverflow.com/questions/20353846/mockito-difference-between-doreturn-and-when" class="external-link">ç”¨å“ªä¸ª</a>. <br />
å®˜æ–¹æ¨èä¼˜å…ˆä½¿ç”¨<code>When/Then</code>,å› ä¸ºå¯ä»¥ä¿è¯è¿”å›çš„ç±»å‹æ˜¯ç¬¦åˆé¢„æœŸçš„,å¹¶ä¸”ä¹Ÿæ›´å¯è¯».ä½†å½“ä¸éœ€è¦æ‰§è¡Œå®é™…çš„æ–¹æ³•çš„æ—¶å€™,åº”è¯¥ç”¨<code>Do/When</code>,æ¯”å¦‚:   </p>
<ol>
<li>mock <code>void</code>æ–¹æ³•æ—¶,ä½¿ç”¨<code>doNothing/when</code>(ä¸æ‰§è¡Œwhenä¸­çš„æ–¹æ³•)   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="n">Object</span><span class="w"> </span><span class="n">o</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">mock</span><span class="p">(</span><span class="n">Object</span><span class="p">.</span><span class="na">class</span><span class="p">);</span>
<span class="n">doNothing</span><span class="p">().</span><span class="na">when</span><span class="p">(</span><span class="n">o</span><span class="p">).</span><span class="na">notify</span><span class="p">();</span>
</code></pre></div>


</div>

<ol>
<li>spyå¯¹è±¡çš„æ—¶å€™   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="n">List</span><span class="w"> </span><span class="n">list</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">LinkedList</span><span class="p">();</span><span class="w">  </span>
<span class="n">List</span><span class="w"> </span><span class="n">spy</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">spy</span><span class="p">(</span><span class="n">list</span><span class="p">);</span><span class="w">  </span>

<span class="c1">//Impossible: real method is called so spy.get(0) throws IndexOutOfBoundsException (the list is yet empty)  </span>
<span class="n">when</span><span class="p">(</span><span class="n">spy</span><span class="p">.</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">)).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">);</span><span class="w">  </span>

<span class="c1">//You have to use doReturn() for stubbing  </span>
<span class="n">doReturn</span><span class="p">(</span><span class="s">&quot;foo&quot;</span><span class="p">).</span><span class="na">when</span><span class="p">(</span><span class="n">spy</span><span class="p">).</span><span class="na">get</span><span class="p">(</span><span class="mi">0</span><span class="p">);</span><span class="w">  </span>
</code></pre></div>


</div>

<ol>
<li>è¿ç»­å¯¹è°ƒç”¨æ–¹æ³•æ‰“æ¡©(Stub)<sup id="fnref:1"><a class="footnote-ref" href="#fn:1">1</a></sup> <br />
å€¼å¾—ä¸€æçš„æ˜¯,è¿ç»­æ‰“æ¡©æ–¹æ³•ç›´æ¥å†™æ˜¯åç›´è§‰çš„:   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="c1">// è¿™ä¸ªå’Œç›´è§‰ä¸ä¸€æ ·!è¿™ä¸ªè°ƒç”¨çš„æ—¶å€™åªä¼šè¿”å›&quot;world&quot;</span>
<span class="n">when</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="na">toString</span><span class="p">()).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">);</span><span class="w"> </span>
<span class="n">when</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="na">toString</span><span class="p">()).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">);</span>

<span class="c1">// ä¸‹é¢éƒ½å¯ä»¥ç¬¬ä¸€æ¬¡è¿”å›&quot;Hello&quot;,ç¬¬äºŒæ¬¡è¿”å›&quot;World&quot;</span>
<span class="c1">// ç¬¬ä¸€ç§æ–¹å¼ </span>
<span class="n">when</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="na">toString</span><span class="p">()).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">);</span>
<span class="c1">// ç¬¬äºŒç§æ–¹å¼</span>
<span class="n">when</span><span class="p">(</span><span class="n">o</span><span class="p">.</span><span class="na">toString</span><span class="p">()).</span><span class="na">thenReturn</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">,</span><span class="w"> </span><span class="s">&quot;World&quot;</span><span class="p">);</span>
<span class="c1">// ç¬¬ä¸‰ç§æ–¹å¼</span>
<span class="n">doReturn</span><span class="p">(</span><span class="s">&quot;Hello&quot;</span><span class="p">).</span><span class="na">when</span><span class="p">(</span><span class="n">o</span><span class="p">).</span><span class="na">toString</span><span class="p">();</span>
<span class="n">doReturn</span><span class="p">(</span><span class="s">&quot;World&quot;</span><span class="p">).</span><span class="na">when</span><span class="p">(</span><span class="n">o</span><span class="p">).</span><span class="na">toString</span><span class="p">();</span>
</code></pre></div>


</div>

<p>åƒä¸Šé¢è¿™ç§ååŠéƒ¨åˆ†çš„è¿ç»­æ–¹æ³•è°ƒç”¨ä½¿ç”¨<code>when/then</code>æˆ–<code>do/when</code>éƒ½æ˜¯å¯ä»¥çš„,ä½†è¿˜æœ‰ä¸€ç§åªèƒ½ç”¨åè€…,å³å‰ä¸€æ¬¡è°ƒç”¨æŒ‡å®šäº†è¦è¿”å›å¼‚å¸¸,åé¢åˆæ‰“ç®—è¦†ç›–å®ƒçš„æ—¶å€™(è™½ç„¶è¿™æ ·çœŸçš„æœ‰ç‚¹å¥‡æ€ª):   </p>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="n">when</span><span class="p">(</span><span class="n">mock</span><span class="p">.</span><span class="na">foo</span><span class="p">())</span>
<span class="p">.</span><span class="na">thenThrow</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">RuntimeException</span><span class="p">());</span>

<span class="c1">// åé¢æƒ³è¦ç›´æ¥è¦†ç›–ä¸Šé¢çš„æŠ›å¼‚å¸¸æ‰“æ¡©</span>
<span class="n">when</span><span class="p">(</span><span class="n">mock</span><span class="p">.</span><span class="na">foo</span><span class="p">()).</span><span class="na">whenReturn</span><span class="p">(</span><span class="s">&quot;I will be not returned&quot;</span><span class="p">);</span>

<span class="c1">// å¿…é¡»ç”¨Do/When</span>
<span class="n">doReturn</span><span class="p">(</span><span class="s">&quot;I will be Returned&quot;</span><span class="p">).</span><span class="na">when</span><span class="p">(</span><span class="n">mock</span><span class="p">).</span><span class="na">foo</span><span class="p">();</span>
</code></pre></div>


</div>

<h3 id="h_3-2-mockito">3.2. MockitoåŸç†</h3>
<p>æ¯”å¦‚<code>when(mockObject.yourMethod()).thenReturn(x)</code>è¿™æ ·çš„æ¨¡å¼,çœ‹èµ·æ¥å¾ˆè¿è´¯,æ˜¯å¯¹<code>yourMenthod()</code>åšäº†ä¸€ä¸ªå­—é¢ä¸Š"æ‹¦æˆª"çš„å°è£…,ä½†æ˜æ˜whenä¸­å®é™…ä¼ å…¥çš„åªæ˜¯ä¸€ä¸ªæ–¹æ³•è¿”å›å€¼è€Œå·²,åˆ°åº•æ˜¯æ€ä¹ˆå®Œæˆå¯¹<code>yourMethod()</code>è¿™ä¸ªæ–¹æ³•è¿›è¡Œæ‰“æ¡©çš„å‘¢?<sup id="fnref:2"><a class="footnote-ref" href="#fn:2">2</a></sup>   </p>
<p>Mockitoæœ¬è´¨ä¸Šå°±æ˜¯åœ¨ä»£ç†å¯¹è±¡è°ƒç”¨æ–¹æ³•å‰ï¼Œç”¨stubçš„æ–¹å¼è®¾ç½®å…¶è¿”å›å€¼ï¼Œç„¶ååœ¨çœŸå®è°ƒç”¨æ—¶ï¼Œç”¨ä»£ç†å¯¹è±¡è¿”å›èµ·é¢„è®¾çš„è¿”å›å€¼ã€‚ <br />
1. org.mockito.internal.creation.bytebuddy.BytecodeGenerator#mockClass åˆ©ç”¨ByteBuddyä¸­ç”Ÿæˆä»£ç†ç±» <br />
ByteBuddyä½¿ç”¨ç¤ºä¾‹:   </p>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="n">Class</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">dynamicType</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ByteBuddy</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">subclass</span><span class="p">(</span><span class="n">Object</span><span class="p">.</span><span class="na">class</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">method</span><span class="p">(</span><span class="n">ElementMatchers</span><span class="p">.</span><span class="na">named</span><span class="p">(</span><span class="s">&quot;toString&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="na">intercept</span><span class="p">(</span><span class="n">FixedValue</span><span class="p">.</span><span class="na">value</span><span class="p">(</span><span class="s">&quot;Hello World!&quot;</span><span class="p">))</span>
<span class="w">        </span><span class="p">.</span><span class="na">make</span><span class="p">()</span>
<span class="w">        </span><span class="p">.</span><span class="na">load</span><span class="p">(</span><span class="n">Object</span><span class="p">.</span><span class="na">class</span><span class="p">.</span><span class="na">getClassLoader</span><span class="p">(),</span><span class="w"> </span><span class="n">ClassLoadingStrategy</span><span class="p">.</span><span class="na">Default</span><span class="p">.</span><span class="na">WRAPPER</span><span class="p">)</span>
<span class="w">        </span><span class="p">.</span><span class="na">getLoaded</span><span class="p">();</span>
<span class="n">StdOut</span><span class="p">.</span><span class="na">println</span><span class="p">(</span><span class="n">dynamicType</span><span class="p">.</span><span class="na">getSimpleName</span><span class="p">()</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="s">&quot;  &quot;</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">dynamicType</span><span class="p">.</span><span class="na">toString</span><span class="p">());</span>
<span class="c1">// è¾“å‡º: Object$ByteBuddy$cmpHDO82   Hello World!</span>
</code></pre></div>


</div>

<ol>
<li>ç¼“å­˜ä»£ç†ç±»,å¤šæ¬¡è¯·æ±‚è¿”å›åŒä¸€ä¸ªä»£ç†ç±»   </li>
<li>åœ¨æ‰§è¡Œæ–¹æ³•è°ƒç”¨æ—¶ä¿å­˜å½“å‰æ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡åˆ°æŸä¸ªå­—æ®µï¼ˆorg.mockito.internal.stubbing.InvocationContainerImpl#invocationForStubbingå­—æ®µï¼‰   </li>
<li>åŸºäºæ–¹æ³•è°ƒç”¨ä¸Šä¸‹æ–‡ä¿¡æ¯è¿”å›<code>InterceptedInvocation</code>å¯¹è±¡æ¥è¡¨ç¤ºä¸€æ¬¡æ–¹æ³•è°ƒç”¨   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="c1">// org.mockito.internal.creation.bytebuddy.MockMethodInterceptor.DispatcherDefaultingToRealMethod#interceptAbstract</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="nf">interceptAbstract</span><span class="p">(</span><span class="nd">@This</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">mock</span><span class="p">,</span><span class="w"> </span><span class="c1">// å½“å‰ä»£ç†ç±»</span>
<span class="w">                                       </span><span class="nd">@FieldValue</span><span class="p">(</span><span class="s">&quot;mockitoInterceptor&quot;</span><span class="p">)</span><span class="w"> </span><span class="n">MockMethodInterceptor</span><span class="w"> </span><span class="n">interceptor</span><span class="p">,</span><span class="w"> </span><span class="c1">// æ–¹æ³•æ‹¦æˆªå™¨</span>
<span class="w">                                       </span><span class="nd">@StubValue</span><span class="w"> </span><span class="n">Object</span><span class="w"> </span><span class="n">stubValue</span><span class="p">,</span><span class="w"> </span><span class="c1">// stubå€¼ï¼Œè¿™é‡Œä¸ºnull</span>
<span class="w">                                       </span><span class="nd">@Origin</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">invokedMethod</span><span class="p">,</span><span class="w"> </span><span class="c1">// å½“å‰è°ƒç”¨æ–¹æ³•</span>
<span class="w">                                       </span><span class="nd">@AllArguments</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">arguments</span><span class="p">)</span><span class="w"> </span><span class="cm">/* æ–¹æ³•å…¥å‚ */</span><span class="w"> </span><span class="kd">throws</span><span class="w"> </span><span class="n">Throwable</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">interceptor</span><span class="w"> </span><span class="o">==</span><span class="w"> </span><span class="kc">null</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stubValue</span><span class="p">;</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">interceptor</span><span class="p">.</span><span class="na">doIntercept</span><span class="p">(</span>
<span class="w">            </span><span class="n">mock</span><span class="p">,</span>
<span class="w">            </span><span class="n">invokedMethod</span><span class="p">,</span>
<span class="w">            </span><span class="n">arguments</span><span class="p">,</span>
<span class="w">            </span><span class="n">RealMethod</span><span class="p">.</span><span class="na">IsIllegal</span><span class="p">.</span><span class="na">INSTANCE</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kd">static</span><span class="w"> </span><span class="n">InterceptedInvocation</span><span class="w"> </span><span class="nf">createInvocation</span><span class="p">(</span><span class="n">Object</span><span class="w"> </span><span class="n">mock</span><span class="p">,</span><span class="w"> </span><span class="n">Method</span><span class="w"> </span><span class="n">invokedMethod</span><span class="p">,</span><span class="w"> </span><span class="n">Object</span><span class="o">[]</span><span class="w"> </span><span class="n">arguments</span><span class="p">,</span><span class="w"> </span><span class="n">RealMethod</span><span class="w"> </span><span class="n">realMethod</span><span class="p">,</span><span class="w"> </span><span class="n">MockCreationSettings</span><span class="w"> </span><span class="n">settings</span><span class="p">,</span><span class="w"> </span><span class="n">Location</span><span class="w"> </span><span class="n">location</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">InterceptedInvocation</span><span class="p">(</span>
<span class="w">        </span><span class="k">new</span><span class="w"> </span><span class="n">MockWeakReference</span><span class="o">&lt;</span><span class="n">Object</span><span class="o">&gt;</span><span class="p">(</span><span class="n">mock</span><span class="p">),</span>
<span class="w">        </span><span class="n">createMockitoMethod</span><span class="p">(</span><span class="n">invokedMethod</span><span class="p">,</span><span class="w"> </span><span class="n">settings</span><span class="p">),</span>
<span class="w">        </span><span class="n">arguments</span><span class="p">,</span>
<span class="w">        </span><span class="n">realMethod</span><span class="p">,</span>
<span class="w">        </span><span class="n">location</span><span class="p">,</span>
<span class="w">        </span><span class="n">SequenceNumber</span><span class="p">.</span><span class="na">next</span><span class="p">()</span><span class="w"> </span><span class="c1">// æ¯ä¸ªInterceptedInvocationå¯¹è±¡éƒ½æœ‰ä¸€ä¸ªå”¯ä¸€åºå·</span>
<span class="w">    </span><span class="p">);</span>
<span class="p">}</span>
</code></pre></div>


</div>

<ol>
<li>å½“Mockito.when()å†æ¬¡è°ƒç”¨æ—¶æ ¹æ®InterceptedInvocationå¯¹è±¡æŸ¥æ‰¾å¯¹åº”çš„stubï¼Œå¦‚æœæ‰¾åˆ°åˆ™ä½¿ç”¨è¯¥stubè¿”å›ç‰¹å®šå€¼ï¼Œå¦åˆ™è¿”å›é»˜è®¤å€¼ï¼ˆint ä¼šè¿”å› 0ï¼Œå¸ƒå°”å€¼è¿”å› false,å…¶ä»– type ä¼šè¿”å› nullï¼‰   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="c1">// // org.mockito.internal.handler.MockHandlerImpl#handle</span>
<span class="c1">// æ ¹æ®invocationåŒ¹é…å¯¹åº”çš„stubï¼ŒåŒ¹é…è§„åˆ™æ˜¯ classç›¸åŒ+æ–¹æ³•ç­¾åç›¸åŒ+å…¥å‚åŒ¹é…</span>
<span class="n">StubbedInvocationMatcher</span><span class="w"> </span><span class="n">stubbing</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">invocationContainer</span><span class="p">.</span><span class="na">findAnswerFor</span><span class="p">(</span><span class="n">invocation</span><span class="p">);</span>
</code></pre></div>


</div>

<ol>
<li>stubä¸­çš„å€¼æ˜¯thenReturn()ä¸­å¡å…¥çš„   </li>
</ol>
<div class="lang-java">

<div class="codehilite"><pre><span></span><code><span class="kd">public</span><span class="w"> </span><span class="n">OngoingStubbing</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">thenReturn</span><span class="p">(</span><span class="n">T</span><span class="w"> </span><span class="n">value</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">thenAnswer</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">Returns</span><span class="p">(</span><span class="n">value</span><span class="p">));</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="n">OngoingStubbing</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="w"> </span><span class="nf">thenAnswer</span><span class="p">(</span><span class="n">Answer</span><span class="o">&lt;?&gt;</span><span class="w"> </span><span class="n">answer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">invocationContainer</span><span class="p">.</span><span class="na">addAnswer</span><span class="p">(</span><span class="n">answer</span><span class="p">);</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">ConsecutiveStubbing</span><span class="o">&lt;</span><span class="n">T</span><span class="o">&gt;</span><span class="p">(</span><span class="n">invocationContainer</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="kt">void</span><span class="w"> </span><span class="nf">addAnswer</span><span class="p">(</span><span class="n">Answer</span><span class="w"> </span><span class="n">answer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">     </span><span class="c1">// ç§»é™¤æœ€è¿‘ä¸€æ¬¡æ–¹æ³•è°ƒç”¨ä¿å­˜çš„invocationä¿¡æ¯</span>
<span class="w">    </span><span class="n">registeredInvocations</span><span class="p">.</span><span class="na">removeLast</span><span class="p">();</span>
<span class="w">    </span><span class="c1">//</span>
<span class="w">    </span><span class="n">addAnswer</span><span class="p">(</span><span class="n">answer</span><span class="p">,</span><span class="w"> </span><span class="kc">false</span><span class="p">);</span>
<span class="p">}</span>
<span class="kd">public</span><span class="w"> </span><span class="n">StubbedInvocationMatcher</span><span class="w"> </span><span class="nf">addAnswer</span><span class="p">(</span><span class="n">Answer</span><span class="w"> </span><span class="n">answer</span><span class="p">,</span><span class="w"> </span><span class="kt">boolean</span><span class="w"> </span><span class="n">isConsecutive</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">    </span><span class="n">Invocation</span><span class="w"> </span><span class="n">invocation</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">invocationForStubbing</span><span class="p">.</span><span class="na">getInvocation</span><span class="p">();</span>
<span class="w">    </span><span class="n">mockingProgress</span><span class="p">().</span><span class="na">stubbingCompleted</span><span class="p">();</span>
<span class="w">    </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">answer</span><span class="w"> </span><span class="k">instanceof</span><span class="w"> </span><span class="n">ValidableAnswer</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="p">((</span><span class="n">ValidableAnswer</span><span class="p">)</span><span class="w"> </span><span class="n">answer</span><span class="p">).</span><span class="na">validateFor</span><span class="p">(</span><span class="n">invocation</span><span class="p">);</span>
<span class="w">    </span><span class="p">}</span>
<span class="w">    </span><span class="kd">synchronized</span><span class="w"> </span><span class="p">(</span><span class="n">stubbed</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="k">if</span><span class="w"> </span><span class="p">(</span><span class="n">isConsecutive</span><span class="p">)</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// è¿ç»­æ–¹å¼</span>
<span class="w">            </span><span class="c1">// è¿ç»­:é’ˆå¯¹åŒä¸€ä¸ªæ–¹æ³•çš„å¤šæ¬¡è°ƒç”¨ï¼Œå¯ä»¥æŒ‰ç…§é¡ºåºè‡ªå®šä¹‰ä¸åŒçš„è¿”å›å€¼ï¼Œå¦‚æœè°ƒç”¨æ¬¡æ•°è¶…è¿‡äº†è‡ªå®šä¹‰è¿”å›å€¼ä¸ªæ•°ï¼Œé»˜è®¤åç»­ä»¥æœ€åä¸€ä¸ªè‡ªå®šä¹‰è¿”å›å€¼ä¸ºå‡†</span>
<span class="w">            </span><span class="n">stubbed</span><span class="p">.</span><span class="na">getFirst</span><span class="p">().</span><span class="na">addAnswer</span><span class="p">(</span><span class="n">answer</span><span class="p">);</span>
<span class="w">        </span><span class="p">}</span><span class="w"> </span><span class="k">else</span><span class="w"> </span><span class="p">{</span>
<span class="w">            </span><span class="c1">// éè¿ç»­</span>
<span class="w">            </span><span class="n">stubbed</span><span class="p">.</span><span class="na">addFirst</span><span class="p">(</span><span class="k">new</span><span class="w"> </span><span class="n">StubbedInvocationMatcher</span><span class="p">(</span><span class="n">invocationForStubbing</span><span class="p">,</span><span class="w"> </span><span class="n">answer</span><span class="p">));</span>
<span class="w">        </span><span class="p">}</span>
<span class="w">        </span><span class="k">return</span><span class="w"> </span><span class="n">stubbed</span><span class="p">.</span><span class="na">getFirst</span><span class="p">();</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</code></pre></div>


</div>

<div class="footnote">
<hr />
<ol>
<li id="fn:1">
<p><a href="[https://www.cnblogs.com/vvonline/p/4122991.html" class="external-link">ä½¿ç”¨Mockitoè¿›è¡Œå•å…ƒæµ‹è¯•ã€2ã€‘â€”â€” stub å’Œ é«˜çº§ç‰¹æ€§</a>](https://www.cnblogs.com/vvonline/p/4122991.html))&#160;<a class="footnote-backref" href="#fnref:1" title="Jump back to footnote 0 in the text">&#8617;</a></p>
</li>
<li id="fn:2">
<p><a href="https://mp.weixin.qq.com/s?__biz=MzIwNTI2ODY5OA==&amp;mid=2649938607&amp;idx=1&amp;sn=7e17607eb5a537f7734631030d289351&amp;chksm=8f35091ab842800cc88e928fdedd763334c4e6c4c2f750bfc2a04499d41a629740c2f16e78d4&amp;mpshare=1&amp;scene=1&amp;srcid=05068BrILyHdI932MoGI4ikG&amp;sharer_sharetime=1654096335341&amp;sharer_shareid=3d1ec1ef36d6bd7731355ba2c32a8737&amp;key=c679381433df56e2c6adb0d9c6bb48c04cc315ab1b4224641fb565255112d2f0fa6503e5021648d71d2455a199908bd3725283025aa8741a98755e166346ab6ae74f57ae47e10e42ff3ee5dfd243e35f781d9868e43631c475f9698e0ee2c87c1cfe2d5fb3d9abe66fcec4c20327efb6ebd835b47a909d82bed0d007ff629278&amp;ascene=1&amp;uin=MTM2NzczNTcyNQ%3D%3D&amp;devicetype=Windows+10+x64&amp;version=62090529&amp;lang=zh_CN&amp;exportkey=A750s8ExPSWt6dXOhhFNtUU%3D&amp;acctmode=1&amp;pass_ticket=T7MOwQn%2BscxKfclR6Z%2BadHwqUH8ePToAk1KmbgAgFLDFaQtcA6XNlg0kQMgvPvqO&amp;wx_header=0" class="external-link">mockitoåŸç†æµ…æ</a>&#160;<a class="footnote-backref" href="#fnref:2" title="Jump back to footnote 1 in the text">&#8617;</a></p>
</li>
</ol>
</div></div>
<div class="note-footer">
<div class="backlinks">
<h2>Backlinks</h2>
<ul>
	<li><a class="backlink" href="/program/full-stream/Test/Unit Level Test Theoryã€Toolã€Discussion.html">unit level test theoryã€toolã€discussion</a></li>
	<li><a class="backlink" href="/program/full-stream/Full-Stream.html">full-stream</a></li>
	<li><a class="backlink" href="/index.html">index</a></li>
</ul>
</div>

<div class="tags">

</div>

</div>
<div class="graph requires_js ">
    <div id="A315744784472918452047857152049737346266{level}" class="graph_div"></div>

    <div class="graph-instructions" id="D315744784472918452047857152049737346266{level}">
        Left-click: follow link, Right-click: select node, Scroll: zoom
    </div>
    
    <div class="graph-button-row" style="display:flex;">
        <button class="graph_button graph_show_button" id="B315744784472918452047857152049737346266{level}" level="{level}" note_temp_id="315744784472918452047857152049737346266" onclick="window.ObsHtmlGraph.run(this, '315744784472918452047857152049737346266', 'junit5 & mockito');">
            Show Graph
        </button>
        <button class="graph_button graph_type_button" id="C315744784472918452047857152049737346266{level}" style="flex:1" onclick="window.ObsHtmlGraph.switch_graph_type(this);">
            2D
        </button>
    </div>
</div>

<script type="module">
    if (window.ObsHtmlGraph == undefined){
        import('/obs.html/static/graph.js').then((Module) => {
            window.ObsHtmlGraph = Module;
            window.ObsHtmlGraph.arm_page(document.getElementById('page_holder'))
        })
    }
</script>




                                <!-- end content -->
                        </div>
                        <div class="container_filler">
                        </div>
                        <div id="right_pane" class="right_pane active">
    <div id="right_pane_fold_header" class="right_pane_fold_header fold_header">x</div>
    <div id="right_pane_content" class="right_pane_content">
            
    </div>
</div>
                </div>
        </div>

        <script>
                function handle_toggle_side_bar(e){
                        let header;
                        let pane; 
                        let target = e.target

                        // switch out the navbar button click for a header click
                        if (target.id == 'left_pane_toggle_nav'){
                                target = document.getElementById('left_pane_fold_header')
                        }
                        else if (target.id == 'right_pane_toggle_nav'){
                                target = document.getElementById('right_pane_fold_header')
                        }

                        // get header and pane
                        if (target.classList.contains('fold_header')) {
                                header = target;
                                pane = target.parentElement;
                        }
                        else {
                                pane = target;
                                header = target.getElementsByClassName('fold_header')[0];
                        }
                        toggle_side_bar(pane, header, true)
                        e.stopPropagation();
                }
                function handle_toggle_side_bar_button(e){
                        document.getElementById('menu_toggle_button').click()
                        handle_toggle_side_bar(e);
                }

                function toggle_side_bar(pane, header, save) {
                        let active = (pane.classList.contains('active'))
                        if (active){
                                disable_side_bar(pane, header, save);
                        }
                        else {
                                enable_side_bar(pane, header, save);
                        }
                }
                function enable_side_bar(pane, header, save){
                        pane.classList.add('active');
                        pane.removeEventListener('click', handle_toggle_side_bar);
                        header.addEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, true) }
                }
                function disable_side_bar(pane, header, save){
                        pane.classList.remove('active');
                        pane.addEventListener('click', handle_toggle_side_bar);
                        header.removeEventListener('click', handle_toggle_side_bar);
                        set_correct_header_symbol(header);
                        if (save){ save_panel_folding_state(header, false) }
                }
                function set_correct_header_symbol(header){
                        let pane = header.parentElement;
                        let symbol = [['>', '<'],['<', '>']]
                        symbol = symbol[Number(header.classList.contains('right_pane_fold_header'))][Number(pane.classList.contains('active'))];
                        console.log(symbol);
                        header.innerHTML = symbol
                        return header;
                }
                function panel_folding_get_panel_name(header){
                        return ['left', 'right'][Number(header.classList.contains('right_pane_fold_header'))]
                }
                function save_panel_folding_state(header, active){
                        ls_set('pane_folding_state_'+panel_folding_get_panel_name(header), Number(active));
                }
                function load_panel_folding_state(panel_name){
                        val = ls_get('pane_folding_state_'+panel_name)
                        if (!val){ return {'exists': false, 'value': null}}
                        return {'exists': true, 'value': Boolean(Number(val))}
                }
                function set_pane_folding_start(left_header, right_header){
                        // small screen = closed
                        let right_pane_enabled = true;
                        let left_pane_enabled = true;
                        let w = window.visualViewport.width
                        if (w < 1000){
                                left_pane_enabled = false
                        }
                        if (w < 800){
                                right_pane_enabled = false
                        }

                        // get saved values if present
                        let rval = load_panel_folding_state('right')
                        if (rval['exists']){
                                right_pane_enabled = rval['value']
                        }
                        let lval = load_panel_folding_state('left')
                        if (lval['exists']){
                                left_pane_enabled = lval['value']
                        }

                        // default = enabled, so we only need to disable
                        if (!left_pane_enabled){
                                disable_side_bar(document.getElementById('left_pane'), document.getElementById('left_pane_fold_header'))
                        }
                        if (!right_pane_enabled){
                                disable_side_bar(document.getElementById('right_pane'), document.getElementById('right_pane_fold_header'))
                        }
                }

                function init_pane_folding(header){
                        set_correct_header_symbol(header);
                        header.addEventListener('click', handle_toggle_side_bar);
                }
                
                
                set_pane_folding_start()
                init_pane_folding(document.getElementById('left_pane_fold_header'));
                init_pane_folding(document.getElementById('right_pane_fold_header'));

                document.getElementById('left_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
                document.getElementById('right_pane_toggle_nav').addEventListener('click', handle_toggle_side_bar_button);
        </script>

        <script src="/obs.html/static/load_dirtree_footer.js" type="text/javascript"></script>

        




</body>
</html>
